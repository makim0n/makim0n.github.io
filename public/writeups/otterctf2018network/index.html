<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>[OtterCTF] - Network - Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)</title><meta name=Description content="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><meta property="og:title" content="[OtterCTF] - Network"><meta property="og:description" content="Network There are 4 network challenges during this CTF, I only solved 3 of them, here is how.
Birdman&rsquo;s Data State of the art The PCAP file is not really big, I decided to open it using Wireshark. There are few things to notice:
Data in UDP protocol HTTP packets to txtwizard.net There nothing interesting in UDP traffic, data does not represent much.
On the other hand, HTTP traffic is very interesting."><meta property="og:type" content="article"><meta property="og:url" content="maki.bzh/writeups/otterctf2018network/"><meta property="og:image" content="/logo.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2018-12-24T21:57:40+08:00"><meta property="article:modified_time" content="2018-12-24T21:57:40+08:00"><meta property="og:site_name" content="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/logo.png"><meta name=twitter:title content="[OtterCTF] - Network"><meta name=twitter:description content="Network There are 4 network challenges during this CTF, I only solved 3 of them, here is how.
Birdman&rsquo;s Data State of the art The PCAP file is not really big, I decided to open it using Wireshark. There are few things to notice:
Data in UDP protocol HTTP packets to txtwizard.net There nothing interesting in UDP traffic, data does not represent much.
On the other hand, HTTP traffic is very interesting."><meta name=application-name content="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><meta name=apple-mobile-web-app-title content="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=maki.bzh/writeups/otterctf2018network/><link rel=prev href=maki.bzh/writeups/santhachlaus2018archdrive/><link rel=next href=maki.bzh/writeups/otterctf2018memorydump/><link rel=stylesheet href=/maki.bzh/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"[OtterCTF] - Network","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"maki.bzh\/writeups\/otterctf2018network\/"},"image":["\/images\/Apple-Devices-Preview.png"],"genre":"writeups","keywords":"otterctf, forensic, pcap, cryptography, aes, usb, smbv2, wireshark","wordcount":1361,"url":"maki.bzh\/writeups\/otterctf2018network\/","datePublished":"2018-12-24T21:57:40+08:00","dateModified":"2018-12-24T21:57:40+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"xxxx","logo":"\/lib\/images\/avatar.png"},"author":{"@type":"Person","name":"Maki"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'dark'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'dark'==='dark')&&document.body.setAttribute('theme','dark')</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=maki.bzh/ title="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><span class=header-title-pre><i class='far fa-kiss-wink-heart fa-fw' aria-hidden=true></i></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/maki.bzh/posts/>Posts </a><a class=menu-item href=/maki.bzh/shorts/>Shorts </a><a class=menu-item href=/maki.bzh/offers/>Offers </a><a class=menu-item href=/maki.bzh/writeups/>Writeups </a><a class=menu-item href=/maki.bzh/tags/>Tags </a><a class=menu-item href=/maki.bzh/about/>About </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=maki.bzh/ title="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><span class=header-title-pre><i class='far fa-kiss-wink-heart fa-fw' aria-hidden=true></i></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/maki.bzh/posts/ title>Posts</a><a class=menu-item href=/maki.bzh/shorts/ title>Shorts</a><a class=menu-item href=/maki.bzh/offers/ title>Offers</a><a class=menu-item href=/maki.bzh/writeups/ title>Writeups</a><a class=menu-item href=/maki.bzh/tags/ title>Tags</a><a class=menu-item href=/maki.bzh/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class="page single special"><h1 class="single-title animate__animated animate__pulse animate__faster">[OtterCTF] - Network</h1><div class=content id=content><h1 id=network>Network</h1><p>There are 4 network challenges during this CTF, I only solved 3 of them, here is how.</p><h2 id=birdmans-data>Birdman&rsquo;s Data</h2><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/2018_otterctf/network/statement_net1.png data-srcset="/lib/images/writeups/2018_otterctf/network/statement_net1.png, /lib/images/writeups/2018_otterctf/network/statement_net1.png 1.5x, /lib/images/writeups/2018_otterctf/network/statement_net1.png 2x" data-sizes=auto alt=/lib/images/writeups/2018_otterctf/network/statement_net1.png title=/lib/images/writeups/2018_otterctf/network/statement_net1.png></p><h3 id=state-of-the-art>State of the art</h3><p>The PCAP file is not really big, I decided to open it using Wireshark. There are few things to notice:</p><ul><li>Data in UDP protocol</li><li>HTTP packets to <code>txtwizard.net</code></li></ul><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/2018_otterctf/network/net1_1.png data-srcset="/lib/images/writeups/2018_otterctf/network/net1_1.png, /lib/images/writeups/2018_otterctf/network/net1_1.png 1.5x, /lib/images/writeups/2018_otterctf/network/net1_1.png 2x" data-sizes=auto alt=/lib/images/writeups/2018_otterctf/network/net1_1.png title=/lib/images/writeups/2018_otterctf/network/net1_1.png></p><p>There nothing interesting in UDP traffic, data does not represent much.</p><p>On the other hand, HTTP traffic is very interesting.</p><h3 id=crypto-time>&ldquo;Crypto&rdquo; time</h3><p>There is an interesting request:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>POST /crypto/AES/encrypt/CBC/PKCS5 HTTP/1.1
</span></span><span class=line><span class=cl>Host: www.txtwizard.net
</span></span><span class=line><span class=cl>Connection: keep-alive
</span></span><span class=line><span class=cl>Content-Length: 4297
</span></span><span class=line><span class=cl>Accept: application/json, text/javascript, */*; q=0.01
</span></span><span class=line><span class=cl>Origin: http://www.txtwizard.net
</span></span></code></pre></td></tr></table></div></div><p>Oh, AES CBC! We&rsquo;re missing the encrypted data, key and IV&mldr; Just scroll a little bit ;)</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/2018_otterctf/network/net1_2.png data-srcset="/lib/images/writeups/2018_otterctf/network/net1_2.png, /lib/images/writeups/2018_otterctf/network/net1_2.png 1.5x, /lib/images/writeups/2018_otterctf/network/net1_2.png 2x" data-sizes=auto alt=/lib/images/writeups/2018_otterctf/network/net1_2.png title=/lib/images/writeups/2018_otterctf/network/net1_2.png></p><p>After URL decoding data, I got the key and IV, at the end we got:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Key: XfCtxvD1yFZbxQ/+ULhAcA==
</span></span><span class=line><span class=cl>IV : sEhrZxQpnNnINixu3KQ1Tg==
</span></span><span class=line><span class=cl>Cipher text: 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
</span></span></code></pre></td></tr></table></div></div><p>Quick look on: <a href=http://www.txtwizard.net/crypto target=_blank rel="noopener noreffer">http://www.txtwizard.net/crypto</a></p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/2018_otterctf/network/net1_3.png data-srcset="/lib/images/writeups/2018_otterctf/network/net1_3.png, /lib/images/writeups/2018_otterctf/network/net1_3.png 1.5x, /lib/images/writeups/2018_otterctf/network/net1_3.png 2x" data-sizes=auto alt=/lib/images/writeups/2018_otterctf/network/net1_3.png title=/lib/images/writeups/2018_otterctf/network/net1_3.png></p><p>Here is the decoded data:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Chance Something&#39;s wrong, I can feel it (Six minutes, Slim Shady, you&#39;re on) Just a feeling I&#39;ve got, like something&#39;s about
</span></span><span class=line><span class=cl>To happen, but I don&#39;t know what If that means, what I think it means, we&#39;re in trouble, big trouble, And if he is as bananas as you say, I&#39;m not taking any chances You were just what the doctor ordered I&#39;m beginning to
</span></span><span class=line><span class=cl>Feel like a Rap God, Rap God All my people from the front to the back nod, back nod Now who thinks their arms are long
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>Enough to slap box, slap box? They said I rap like a robot, so call
</span></span><span class=line><span class=cl>me Rapbot But for me to rap like a computer must be
</span></span><span class=line><span class=cl>in my genes I got a laptop in my back pocket My pen&#39;ll go off when I half-c*** it Got a fat knot from that rap profit Made a living and a killing off it Ever since Bill Clinton was still in office With Monica Lewinsky feeling on his
</span></span><span class=line><span class=cl>Nut-sack I&#39;m an MC still as honest But as rude and indecent as all hell syllables, killaholic (Kill &#39;em all with) This slickety, gibbedy, hibbedy hip hop You don&#39;t really wanna get into a pissing match with this rappidy rap Packing a Mac in the back of the Ac, pack backpack rap, yep, yackidy-yac The
</span></span><span class=line><span class=cl>exact same time I attempt these lyrical acrobat stunts while I&#39;m practicing That I&#39;ll still be able to break a
</span></span><span class=line><span class=cl>Motherf***in&#39; table Over the back of a couple of
</span></span><span class=line><span class=cl>_
</span></span><span class=line><span class=cl>Faggots and crack it in half
</span></span><span class=line><span class=cl>Only
</span></span><span class=line><span class=cl>Realized it was ironic I was signed to Aftermath after the fact How could I not blow? All I do is drop F-bombs, feel my wrath of attack Rappers are having a rough time period, here&#39;s a Maxipad It&#39;s actually disastrously bad For the wack while I&#39;m masterfully constructing this masterpiece as I&#39;m beginning to feel
</span></span><span class=line><span class=cl>_
</span></span><span class=line><span class=cl>Like a Rap God, Rap God All my people from the front to the back nod, back nod Now who thinks their arms are long enough to slap box, slap box? Let me show you maintaining this s*** ain&#39;t that hard, that hard Everybody want the key and the secret to rap
</span></span><span class=line><span class=cl>immortality like I have got Well, to be truthful the blueprint&#39;s simply rage and youthful exuberance Everybody loves to root
</span></span><span class=line><span class=cl>for a nuisance Hit the
</span></span><span class=line><span class=cl>Earth like an asteroid, did nothing but shoot for the moon since MC&#39;s
</span></span><span class=line><span class=cl>_
</span></span><span class=line><span class=cl>get taken to school with this music Cause I use it as a vehicle to bust a rhyme Now I lead a new school full of students Me? I&#39;m a product of Rakim, Lakim Shabazz, 2Pac N- -W.A, Cube, hey, Doc, Ren, Yella,
</span></span><span class=line><span class=cl>Eazy, thank you, they got Slim Inspired
</span></span><span class=line><span class=cl>enough to one day grow up, blow up and be in a position To meet Run DMC and induct them into the motherf***in&#39; Rock n&#39; Roll Hall of Fame Even though I walk in the church and burst in a ball of flames Only Hall of Fame I be inducted in is the alcohol of fame On the wall of shame You fags think it&#39;s all a game &#39;til I walk a flock of flames Off of planking, tell me what in the f*** are you thinking? Little gay looking boy So gay I can barely say it with a straight face looking boy You witnessing a massacre Like you watching a church gathering take place looking boy Oy vey, that boy&#39;s gay, that&#39;s all they say looking boy You get a thumbs up, pat on the back And a way to go from your label everyday looking boy Hey, looking boy, what you say looking boy? I got a &#34;hell yeah&#34; from Dre looking boy I&#39;mma work for everything I have Never ask nobody for s***, get outta my face looking boy Basically boy you&#39;re never gonna be capable To keep up with the same pace looking boy &#39;Cause I&#39;m beginning to feel like a Rap God, Rap God All my people from the front to the back nod, back nod The way I&#39;m racing around the track, call me Nascar, Nascar Dale Earnhardt of the trailer park, the White Trash God Kneel before General
</span></span><span class=line><span class=cl>zorb
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><h3 id=flag>Flag</h3><p>Can you see the flag? Just pick the first character of each line:</p><blockquote><p>CTF{EmiNeM_FOR_LifE_gEez}</p></blockquote><h2 id=look-at-me>Look at me</h2><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/2018_otterctf/network/statement_net2.png data-srcset="/lib/images/writeups/2018_otterctf/network/statement_net2.png, /lib/images/writeups/2018_otterctf/network/statement_net2.png 1.5x, /lib/images/writeups/2018_otterctf/network/statement_net2.png 2x" data-sizes=auto alt=/lib/images/writeups/2018_otterctf/network/statement_net2.png title=/lib/images/writeups/2018_otterctf/network/statement_net2.png></p><p>I did this challenge after the CTF ending.</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/2018_otterctf/network/net2_3.png data-srcset="/lib/images/writeups/2018_otterctf/network/net2_3.png, /lib/images/writeups/2018_otterctf/network/net2_3.png 1.5x, /lib/images/writeups/2018_otterctf/network/net2_3.png 2x" data-sizes=auto alt=/lib/images/writeups/2018_otterctf/network/net2_3.png title=/lib/images/writeups/2018_otterctf/network/net2_3.png></p><p>Wacom CTL 471 is a graphical tablet.</p><p>Based on those piece of information, I looked on the internet a CTF writeup. I finally found a writeup of &ldquo;Tom and Jerry&rdquo; challenge from BITSCTF: <a href=https://blogs.tunelko.com/2017/02/05/bitsctf-tom-and-jerry-50-points/ target=_blank rel="noopener noreffer">https://blogs.tunelko.com/2017/02/05/bitsctf-tom-and-jerry-50-points/</a></p><h3 id=data-extraction>Data extraction</h3><p>Frames containing the most interesting data got the following syntax:</p><blockquote><p>02:f1:d9:22:1c:25:4d:03:2b:00</p></blockquote><p>Here is parsing of this frame:</p><ul><li>02:f1 -> Header</li><li>50:1d -> X</li><li>72:1a -> Y</li><li>00:00 -> Pressure</li><li>2b:00 -> Suffix</li></ul><p>It&rsquo;s possible to extract all frames with the following <code>tshark</code> command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ tshark -r lookatme.pcapng -Y <span class=s1>&#39;((usb.transfer_type == 0x01) &amp;&amp; (frame.len == 37))&#39;</span> -Tfields -e usb.capdata &gt; capdata
</span></span></code></pre></td></tr></table></div></div><p>The first condition <code>usb.transfer_type</code> is used to filter the data on sending packets, not the response. It&rsquo;s like filtering on <code>echo request</code> for ICMP data. The second statement filter on data length.</p><h3 id=data-decoding>Data decoding</h3><p>As mentioned in previous writeups, it&rsquo;s necessary to consider all axis, X, Y, and Z. Parsing data is possible with a little <code>awk</code> command, shamefully stolen from the BITSCTF writeup:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ awk -F: <span class=s1>&#39;{x=$3$4;y=$5$6}{z=$7}$1==&#34;02&#34;{print x,y,z}&#39;</span> capdata &gt; hex_value
</span></span></code></pre></td></tr></table></div></div><p>And decoding data with a python script, still stolen from the previous write-up:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/python</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;data_plot&#39;</span><span class=p>,</span><span class=s1>&#39;w&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;hex2&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>readlines</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>ii</span> <span class=o>=</span> <span class=n>i</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>ii</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>ii</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>z</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>ii</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>z</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{0}</span><span class=s2> </span><span class=si>{1}</span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>u16</span><span class=p>(</span><span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s2>&#34;&gt;H&#34;</span><span class=p>,</span> <span class=n>x</span><span class=p>)),</span> <span class=n>u16</span><span class=p>(</span><span class=n>struct</span><span class=o>.</span><span class=n>pack</span><span class=p>(</span><span class=s2>&#34;&gt;H&#34;</span><span class=p>,</span> <span class=n>y</span><span class=p>))))</span>
</span></span></code></pre></td></tr></table></div></div><p>With the last statement I ensure that data contains pressure, it prevents from some garbage during decoding. After that, just use <code>gnuplot</code> to visualize the data:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ gnuplot
</span></span><span class=line><span class=cl>$ plot <span class=s2>&#34;data_plot&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/2018_otterctf/network/net2_1.png data-srcset="/lib/images/writeups/2018_otterctf/network/net2_1.png, /lib/images/writeups/2018_otterctf/network/net2_1.png 1.5x, /lib/images/writeups/2018_otterctf/network/net2_1.png 2x" data-sizes=auto alt=/lib/images/writeups/2018_otterctf/network/net2_1.png title=/lib/images/writeups/2018_otterctf/network/net2_1.png></p><h3 id=flag-1>Flag</h3><p>If I edit the picture a bit, it gives me:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/2018_otterctf/network/net2_2.png data-srcset="/lib/images/writeups/2018_otterctf/network/net2_2.png, /lib/images/writeups/2018_otterctf/network/net2_2.png 1.5x, /lib/images/writeups/2018_otterctf/network/net2_2.png 2x" data-sizes=auto alt=/lib/images/writeups/2018_otterctf/network/net2_2.png title=/lib/images/writeups/2018_otterctf/network/net2_2.png></p><blockquote><p>CTF{0TR_U58}</p></blockquote><h2 id=otter-leak>Otter Leak</h2><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/2018_otterctf/network/statement_net3.png data-srcset="/lib/images/writeups/2018_otterctf/network/statement_net3.png, /lib/images/writeups/2018_otterctf/network/statement_net3.png 1.5x, /lib/images/writeups/2018_otterctf/network/statement_net3.png 2x" data-sizes=auto alt=/lib/images/writeups/2018_otterctf/network/statement_net3.png title=/lib/images/writeups/2018_otterctf/network/statement_net3.png></p><p>For this challenge, I was really lucky. When I opened the PCAP file in my Wireshark I immediately notice some data sent through SMBv2. I configured one column of my Wireshark to display data transferred: <code>data.data</code>:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/2018_otterctf/network/net3_1.png data-srcset="/lib/images/writeups/2018_otterctf/network/net3_1.png, /lib/images/writeups/2018_otterctf/network/net3_1.png 1.5x, /lib/images/writeups/2018_otterctf/network/net3_1.png 2x" data-sizes=auto alt=/lib/images/writeups/2018_otterctf/network/net3_1.png title=/lib/images/writeups/2018_otterctf/network/net3_1.png></p><h3 id=extraction-and-decoding-time>Extraction and decoding time</h3><p>Let&rsquo;s use <code>tshark</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ tshark -r OtterLeak.pcap -Y <span class=s1>&#39;smb2 &amp;&amp; data.data&#39;</span> -Tfields -e data.data <span class=p>|</span> tr -d <span class=s1>&#39; \n&#39;</span> <span class=p>|</span> xxd -r -p
</span></span><span class=line><span class=cl><span class=o>=</span>0iLu4iLg4iLu4SLg4iLu0CIu0CIu4CIu0iLg0SLu4iLg4iLu0SLg0CIt0SLg4CIu4iLu4CIu0iLg0SLt0SLg0SL
</span></span></code></pre></td></tr></table></div></div><p>It looks to be upside down base64, by putting it back in the right place, I will try to decode it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat rev_b64<span class=p>|</span> rev <span class=p>|</span> base64 -d
</span></span><span class=line><span class=cl>-- ----- .-. ..... . --- - --... ...-- .-. .. -. -... -.... ....-
</span></span></code></pre></td></tr></table></div></div><p>Great, morse code. I should be on the right path. <code>dcode</code> website offers morse decoder:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/2018_otterctf/network/net3_2.png data-srcset="/lib/images/writeups/2018_otterctf/network/net3_2.png, /lib/images/writeups/2018_otterctf/network/net3_2.png 1.5x, /lib/images/writeups/2018_otterctf/network/net3_2.png 2x" data-sizes=auto alt=/lib/images/writeups/2018_otterctf/network/net3_2.png title=/lib/images/writeups/2018_otterctf/network/net3_2.png></p><h3 id=flag-2>Flag</h3><blockquote><p>CTF{M0R5EOT73RINB64}</p></blockquote><hr><p>To conclude this little paper, the OtterCTF was an amazing CTF for forensic lovers. Honestly, I really liked it!
If you have any question about this article, feel free to contact me on twitter @Maki_chaz.
Thanks for reading, and merry Christmas guys :)</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://media.giphy.com/media/fjyGsdRkYqb3j1WODz/giphy.gif data-srcset="https://media.giphy.com/media/fjyGsdRkYqb3j1WODz/giphy.gif, https://media.giphy.com/media/fjyGsdRkYqb3j1WODz/giphy.gif 1.5x, https://media.giphy.com/media/fjyGsdRkYqb3j1WODz/giphy.gif 2x" data-sizes=auto alt=https://media.giphy.com/media/fjyGsdRkYqb3j1WODz/giphy.gif title=https://media.giphy.com/media/fjyGsdRkYqb3j1WODz/giphy.gif></p></div></div></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.100.2">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2017 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=maki.bzh/ target=_blank>Maki - Alan Marrec</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},lightgallery:!0}</script><script type=text/javascript src=/maki.bzh/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-WVPYCS7SPM',{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-WVPYCS7SPM" async></script></body></html>