<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>[German FCSC] - Intro to reversing - Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)</title><meta name=Description content="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><meta property="og:title" content="[German FCSC] - Intro to reversing"><meta property="og:description" content="Intro to reversing 1 TL;DR Le mot de passe est hardcodé dans le code. Un simple &ldquo;strings&rdquo; ou une inspection des appels systèmes permet d&rsquo;avoir le mot de passe permettant d&rsquo;obtenir le flag.
Etat des lieux L&rsquo;épreuve commence avec un binaire Linux (ELF) demandans un mot de passe:
Analyse dynamique Un des outils les plus utilisés en analyse dynamique est &ldquo;ltrace&rdquo;. Cette commande permet à un analyste de suivre les appels aux libraries au fur et à mesure de l&rsquo;exécution du binaire."><meta property="og:type" content="article"><meta property="og:url" content="maki.bzh/writeups/fcscallemand2020introrev/"><meta property="og:image" content="/logo.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-02-05T21:57:40+08:00"><meta property="article:modified_time" content="2020-02-05T21:57:40+08:00"><meta property="og:site_name" content="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/logo.png"><meta name=twitter:title content="[German FCSC] - Intro to reversing"><meta name=twitter:description content="Intro to reversing 1 TL;DR Le mot de passe est hardcodé dans le code. Un simple &ldquo;strings&rdquo; ou une inspection des appels systèmes permet d&rsquo;avoir le mot de passe permettant d&rsquo;obtenir le flag.
Etat des lieux L&rsquo;épreuve commence avec un binaire Linux (ELF) demandans un mot de passe:
Analyse dynamique Un des outils les plus utilisés en analyse dynamique est &ldquo;ltrace&rdquo;. Cette commande permet à un analyste de suivre les appels aux libraries au fur et à mesure de l&rsquo;exécution du binaire."><meta name=application-name content="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><meta name=apple-mobile-web-app-title content="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=maki.bzh/writeups/fcscallemand2020introrev/><link rel=prev href=maki.bzh/writeups/fcscallemand2020reme/><link rel=next href=maki.bzh/writeups/fcscallemand2020pwn/><link rel=stylesheet href=/maki.bzh/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"[German FCSC] - Intro to reversing","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"maki.bzh\/writeups\/fcscallemand2020introrev\/"},"image":["\/images\/Apple-Devices-Preview.png"],"genre":"writeups","keywords":"liveoverflow, fcsc, reverse, static, ida","wordcount":583,"url":"maki.bzh\/writeups\/fcscallemand2020introrev\/","datePublished":"2020-02-05T21:57:40+08:00","dateModified":"2020-02-05T21:57:40+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"xxxx","logo":"\/lib\/images\/avatar.png"},"author":{"@type":"Person","name":"Maki"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'dark'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'dark'==='dark')&&document.body.setAttribute('theme','dark')</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=maki.bzh/ title="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><span class=header-title-pre><i class='far fa-kiss-wink-heart fa-fw' aria-hidden=true></i></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/maki.bzh/posts/>Posts </a><a class=menu-item href=/maki.bzh/shorts/>Shorts </a><a class=menu-item href=/maki.bzh/offers/>Offers </a><a class=menu-item href=/maki.bzh/writeups/>Writeups </a><a class=menu-item href=/maki.bzh/tags/>Tags </a><a class=menu-item href=/maki.bzh/about/>About </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=maki.bzh/ title="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><span class=header-title-pre><i class='far fa-kiss-wink-heart fa-fw' aria-hidden=true></i></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/maki.bzh/posts/ title>Posts</a><a class=menu-item href=/maki.bzh/shorts/ title>Shorts</a><a class=menu-item href=/maki.bzh/offers/ title>Offers</a><a class=menu-item href=/maki.bzh/writeups/ title>Writeups</a><a class=menu-item href=/maki.bzh/tags/ title>Tags</a><a class=menu-item href=/maki.bzh/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class="page single special"><h1 class="single-title animate__animated animate__pulse animate__faster">[German FCSC] - Intro to reversing</h1><div class=content id=content><h1 id=intro-to-reversing-1>Intro to reversing 1</h1><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/german_fcsc/introrev/upload_f0ef66205c9dab8a8195e0954ecf4ade.png data-srcset="/lib/images/writeups/german_fcsc/introrev/upload_f0ef66205c9dab8a8195e0954ecf4ade.png, /lib/images/writeups/german_fcsc/introrev/upload_f0ef66205c9dab8a8195e0954ecf4ade.png 1.5x, /lib/images/writeups/german_fcsc/introrev/upload_f0ef66205c9dab8a8195e0954ecf4ade.png 2x" data-sizes=auto alt=/lib/images/writeups/german_fcsc/introrev/upload_f0ef66205c9dab8a8195e0954ecf4ade.png title=/lib/images/writeups/german_fcsc/introrev/upload_f0ef66205c9dab8a8195e0954ecf4ade.png></p><h2 id=tldr>TL;DR</h2><p>Le mot de passe est hardcodé dans le code. Un simple &ldquo;strings&rdquo; ou une inspection des appels systèmes permet d&rsquo;avoir le mot de passe permettant d&rsquo;obtenir le flag.</p><h2 id=etat-des-lieux>Etat des lieux</h2><p>L&rsquo;épreuve commence avec un binaire Linux (ELF) demandans un mot de passe:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/german_fcsc/introrev/upload_1361c5fb2b4eee23a05faa0e0013331d.png data-srcset="/lib/images/writeups/german_fcsc/introrev/upload_1361c5fb2b4eee23a05faa0e0013331d.png, /lib/images/writeups/german_fcsc/introrev/upload_1361c5fb2b4eee23a05faa0e0013331d.png 1.5x, /lib/images/writeups/german_fcsc/introrev/upload_1361c5fb2b4eee23a05faa0e0013331d.png 2x" data-sizes=auto alt=/lib/images/writeups/german_fcsc/introrev/upload_1361c5fb2b4eee23a05faa0e0013331d.png title=/lib/images/writeups/german_fcsc/introrev/upload_1361c5fb2b4eee23a05faa0e0013331d.png></p><h2 id=analyse-dynamique>Analyse dynamique</h2><p>Un des outils les plus utilisés en analyse dynamique est &ldquo;ltrace&rdquo;. Cette commande permet à un analyste de suivre les appels aux libraries au fur et à mesure de l&rsquo;exécution du binaire.</p><p>Etant donné que le programme demande un mot de passe, on peut se douter qu&rsquo;il utilise la fonction &ldquo;strcmp&rdquo;:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/german_fcsc/introrev/upload_16e37b51122e4bfa045fd5da12044731.png data-srcset="/lib/images/writeups/german_fcsc/introrev/upload_16e37b51122e4bfa045fd5da12044731.png, /lib/images/writeups/german_fcsc/introrev/upload_16e37b51122e4bfa045fd5da12044731.png 1.5x, /lib/images/writeups/german_fcsc/introrev/upload_16e37b51122e4bfa045fd5da12044731.png 2x" data-sizes=auto alt=/lib/images/writeups/german_fcsc/introrev/upload_16e37b51122e4bfa045fd5da12044731.png title=/lib/images/writeups/german_fcsc/introrev/upload_16e37b51122e4bfa045fd5da12044731.png></p><p>Finalement, les arguments du strcmp sont affichés et permet d&rsquo;obtenir le flag de validation.</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/german_fcsc/introrev/upload_8f08288ffec3d48c409948ac0c4752e8.png data-srcset="/lib/images/writeups/german_fcsc/introrev/upload_8f08288ffec3d48c409948ac0c4752e8.png, /lib/images/writeups/german_fcsc/introrev/upload_8f08288ffec3d48c409948ac0c4752e8.png 1.5x, /lib/images/writeups/german_fcsc/introrev/upload_8f08288ffec3d48c409948ac0c4752e8.png 2x" data-sizes=auto alt=/lib/images/writeups/german_fcsc/introrev/upload_8f08288ffec3d48c409948ac0c4752e8.png title=/lib/images/writeups/german_fcsc/introrev/upload_8f08288ffec3d48c409948ac0c4752e8.png></p><h2 id=flag>Flag</h2><blockquote><p>CSCG{ez_pz_reversing_squ33zy}</p></blockquote><h1 id=intro-to-reversing-2>Intro to reversing 2</h1><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/german_fcsc/introrev/upload_f01fa204f76c046261db8cdb646c37d6.png data-srcset="/lib/images/writeups/german_fcsc/introrev/upload_f01fa204f76c046261db8cdb646c37d6.png, /lib/images/writeups/german_fcsc/introrev/upload_f01fa204f76c046261db8cdb646c37d6.png 1.5x, /lib/images/writeups/german_fcsc/introrev/upload_f01fa204f76c046261db8cdb646c37d6.png 2x" data-sizes=auto alt=/lib/images/writeups/german_fcsc/introrev/upload_f01fa204f76c046261db8cdb646c37d6.png title=/lib/images/writeups/german_fcsc/introrev/upload_f01fa204f76c046261db8cdb646c37d6.png></p><h2 id=tldr-1>TL;DR</h2><p>Ce challenge de reverse porte sur le reverse d&rsquo;un césar. C&rsquo;est à dire que chaque caractère doit être décalé d&rsquo;un offset de &ldquo;119&rdquo;, ce résultat doit être mis au modulo 256 (nombre de caractère total) et finalement le flag apparait.</p><h2 id=etat-des-lieux-1>Etat des lieux</h2><p>On commence cette épreuve avec un binaire Linux 64 bits. Il n&rsquo;est pas très gros et ne comporte pas énormément de fonctions.</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/german_fcsc/introrev/upload_1683df2400f36564b279300f86fe8d03.png data-srcset="/lib/images/writeups/german_fcsc/introrev/upload_1683df2400f36564b279300f86fe8d03.png, /lib/images/writeups/german_fcsc/introrev/upload_1683df2400f36564b279300f86fe8d03.png 1.5x, /lib/images/writeups/german_fcsc/introrev/upload_1683df2400f36564b279300f86fe8d03.png 2x" data-sizes=auto alt=/lib/images/writeups/german_fcsc/introrev/upload_1683df2400f36564b279300f86fe8d03.png title=/lib/images/writeups/german_fcsc/introrev/upload_1683df2400f36564b279300f86fe8d03.png></p><p>Comme dans le précédent challenge, le traitement doit se faire dans la fonction main. Pour s&rsquo;en assurer, il est de bon de passer ce binaire dans un désassembleur (ida ftw).</p><p>Au premier abort on voit une boucle qui fait un &ldquo;sub&rdquo; de 0x77:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/german_fcsc/introrev/upload_3ecd64849765305cd1e2c677d5779b06.png data-srcset="/lib/images/writeups/german_fcsc/introrev/upload_3ecd64849765305cd1e2c677d5779b06.png, /lib/images/writeups/german_fcsc/introrev/upload_3ecd64849765305cd1e2c677d5779b06.png 1.5x, /lib/images/writeups/german_fcsc/introrev/upload_3ecd64849765305cd1e2c677d5779b06.png 2x" data-sizes=auto alt=/lib/images/writeups/german_fcsc/introrev/upload_3ecd64849765305cd1e2c677d5779b06.png title=/lib/images/writeups/german_fcsc/introrev/upload_3ecd64849765305cd1e2c677d5779b06.png></p><p>N&rsquo;étant pas fan de l&rsquo;assembleur, regardons ce qu&rsquo;il se passe en pseudo code.</p><h2 id=cesar>Cesar</h2><p>Grâce au décompilateur &ldquo;Hexrays&rdquo; de IDA, la boucle est bien plus clair et il est possible de voir qu&rsquo;il s&rsquo;agit d&rsquo;un chiffrement de césar avec un décalage de 119 ou 0x77.</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/german_fcsc/introrev/upload_0b6ccb89b084ec3540398564ef776af3.png data-srcset="/lib/images/writeups/german_fcsc/introrev/upload_0b6ccb89b084ec3540398564ef776af3.png, /lib/images/writeups/german_fcsc/introrev/upload_0b6ccb89b084ec3540398564ef776af3.png 1.5x, /lib/images/writeups/german_fcsc/introrev/upload_0b6ccb89b084ec3540398564ef776af3.png 2x" data-sizes=auto alt=/lib/images/writeups/german_fcsc/introrev/upload_0b6ccb89b084ec3540398564ef776af3.png title=/lib/images/writeups/german_fcsc/introrev/upload_0b6ccb89b084ec3540398564ef776af3.png></p><p>La chaine à retrouvé se trouve dans la section &ldquo;.data&rdquo; sous le doux nom de &ldquo;s2&rdquo;.</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/german_fcsc/introrev/upload_2a59de91dc2d4da19b407fb6a3827073.png data-srcset="/lib/images/writeups/german_fcsc/introrev/upload_2a59de91dc2d4da19b407fb6a3827073.png, /lib/images/writeups/german_fcsc/introrev/upload_2a59de91dc2d4da19b407fb6a3827073.png 1.5x, /lib/images/writeups/german_fcsc/introrev/upload_2a59de91dc2d4da19b407fb6a3827073.png 2x" data-sizes=auto alt=/lib/images/writeups/german_fcsc/introrev/upload_2a59de91dc2d4da19b407fb6a3827073.png title=/lib/images/writeups/german_fcsc/introrev/upload_2a59de91dc2d4da19b407fb6a3827073.png></p><p>On a le chiffré, on a le décalage, il ne reste qu&rsquo;à scripter.</p><h2 id=décodage>Décodage</h2><p>Pour ça, le python est à mon sens le langage le plus approprié.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;</span><span class=se>\xFC</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xFD</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xEA</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xC0</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xBA</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xEC</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xE8</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xFD</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xFB</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xBD</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xF7</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xBE</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xEF</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xB9</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xFB</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xF6</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xBD</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xC0</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xBA</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xB9</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xF7</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xE8</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xF2</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xFD</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xE8</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xF2</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\xFC</span><span class=s2>&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>a</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>((</span><span class=nb>ord</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=o>+</span><span class=mi>119</span><span class=p>)</span><span class=o>%</span><span class=mi>256</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>La liste &ldquo;a&rdquo; est parcouru et chaque caractère est converti en décimal. Ensuite l&rsquo;opération inverse de celle présente dans le binaire est effectuée (on additionne au lieu de soustraire). Finalement, un modulo 256 est appliqué à ces nombres, car il existe 256 symboles dans la table ascii.</p><h2 id=flag-1>Flag</h2><blockquote><p>CSCG{sta71c_tr4n5f0rm4710n_it_is}</p></blockquote><h1 id=intro-to-reversing-3>Intro to reversing 3</h1><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/german_fcsc/introrev/upload_c4b27d3cb597a7de4e7953b64da86ecb.png data-srcset="/lib/images/writeups/german_fcsc/introrev/upload_c4b27d3cb597a7de4e7953b64da86ecb.png, /lib/images/writeups/german_fcsc/introrev/upload_c4b27d3cb597a7de4e7953b64da86ecb.png 1.5x, /lib/images/writeups/german_fcsc/introrev/upload_c4b27d3cb597a7de4e7953b64da86ecb.png 2x" data-sizes=auto alt=/lib/images/writeups/german_fcsc/introrev/upload_c4b27d3cb597a7de4e7953b64da86ecb.png title=/lib/images/writeups/german_fcsc/introrev/upload_c4b27d3cb597a7de4e7953b64da86ecb.png></p><h2 id=tldr-2>TL;DR</h2><p>Comme les deux premiers, il s&rsquo;agit d&rsquo;une petite routine &ldquo;crypto&rdquo;. En l&rsquo;occurence un xor suivi d&rsquo;un décalage. Même logique que précédemment, comprendre la routine, implémenter l&rsquo;inverse et récupérer le flag.</p><h2 id=etat-des-lieux-2>Etat des lieux</h2><p>Encore une fois le binaire est très petit et ne contient pas beaucoup de fonctions. Le traitement se fait dans le main.</p><p>Avec la vue bloc de IDA, on peut identifier deux opérations:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/german_fcsc/introrev/upload_9d66682b95bea539d79d7c37cf57df16.png data-srcset="/lib/images/writeups/german_fcsc/introrev/upload_9d66682b95bea539d79d7c37cf57df16.png, /lib/images/writeups/german_fcsc/introrev/upload_9d66682b95bea539d79d7c37cf57df16.png 1.5x, /lib/images/writeups/german_fcsc/introrev/upload_9d66682b95bea539d79d7c37cf57df16.png 2x" data-sizes=auto alt=/lib/images/writeups/german_fcsc/introrev/upload_9d66682b95bea539d79d7c37cf57df16.png title=/lib/images/writeups/german_fcsc/introrev/upload_9d66682b95bea539d79d7c37cf57df16.png></p><p>Encore une fois, le décompilateur va nous être utile pour comprendre plus facilement ce qu&rsquo;il se passe:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/german_fcsc/introrev/upload_6cb1b91a034d191bc27def526c4bb3be.png data-srcset="/lib/images/writeups/german_fcsc/introrev/upload_6cb1b91a034d191bc27def526c4bb3be.png, /lib/images/writeups/german_fcsc/introrev/upload_6cb1b91a034d191bc27def526c4bb3be.png 1.5x, /lib/images/writeups/german_fcsc/introrev/upload_6cb1b91a034d191bc27def526c4bb3be.png 2x" data-sizes=auto alt=/lib/images/writeups/german_fcsc/introrev/upload_6cb1b91a034d191bc27def526c4bb3be.png title=/lib/images/writeups/german_fcsc/introrev/upload_6cb1b91a034d191bc27def526c4bb3be.png></p><p>La chaine chiffré se situé à nouveau dans &ldquo;.data&rdquo; sous le nom de &ldquo;s2&rdquo;.</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=/lib/images/writeups/german_fcsc/introrev/upload_695271ca52fca941682a5d8d9e50556a.png data-srcset="/lib/images/writeups/german_fcsc/introrev/upload_695271ca52fca941682a5d8d9e50556a.png, /lib/images/writeups/german_fcsc/introrev/upload_695271ca52fca941682a5d8d9e50556a.png 1.5x, /lib/images/writeups/german_fcsc/introrev/upload_695271ca52fca941682a5d8d9e50556a.png 2x" data-sizes=auto alt=/lib/images/writeups/german_fcsc/introrev/upload_695271ca52fca941682a5d8d9e50556a.png title=/lib/images/writeups/german_fcsc/introrev/upload_695271ca52fca941682a5d8d9e50556a.png></p><p>Comme il y a des caractères imprimable, IDA va en faire une chaine de caractère, pour récupérer tout l&rsquo;hex comme sur la capture précédente, il suffit d&rsquo;appuyer sur &ldquo;u&rdquo;, permettant à IDA de supprimer les traitements automatiques et revenir à un tableau d&rsquo;octets brut.</p><h2 id=déchiffrement-du-xor>Déchiffrement du XOR</h2><p>Comme vu précédemment, il y a un xor puis un décalage. Il suffit d&rsquo;implémenter l&rsquo;inverse pour récupérer le flag de validation:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;</span><span class=se>\x6C</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x70</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x60</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x37</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x61</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x3C</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x71</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x4C</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x77</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x1E</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x6B</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x48</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x6F</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x70</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x74</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x28</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x66</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x2D</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x66</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x2A</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x2C</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x6F</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x7D</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x56</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x0F</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x15</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\x4A</span><span class=s2>&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>a</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>tmp</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>])</span><span class=o>+</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>tmp</span><span class=o>^</span><span class=p>(</span><span class=n>i</span><span class=o>+</span><span class=mi>10</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=flag-2>Flag</h2><blockquote><p>CSCG{dyn4m1c_k3y_gen3r4t10n_y34h}</p></blockquote></div></div></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.100.2">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2017 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=maki.bzh/ target=_blank>Maki - Alan Marrec</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},lightgallery:!0}</script><script type=text/javascript src=/maki.bzh/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-WVPYCS7SPM',{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-WVPYCS7SPM" async></script></body></html>