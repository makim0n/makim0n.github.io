<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>[French FCSC] - Académie - Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)</title><meta name=Description content="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><meta property="og:title" content="[French FCSC] - Académie"><meta property="og:description" content="C&rsquo;est la rentrée Bienvenue à l&rsquo;académie de l&rsquo;investigation numérique ! Votre mission, valider un maximum d&rsquo;étapes de cette série afin de démontrer votre dextérité en analyse mémoire GNU/Linux.
Première étape : retrouvez le HOSTNAME, le nom de l&rsquo;utilisateur authentifié lors du dump et la version de Linux sur lequel le dump a été fait.
Format du flag : FCSC{hostname:user:x.x.x-x-amdxx}
TL;DR Cette suite de challenge se base sur le même dump mémoire."><meta property="og:type" content="article"><meta property="og:url" content="maki.bzh/writeups/fcscfrench2020academie/"><meta property="og:image" content="/logo.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-06-27T21:57:40+08:00"><meta property="article:modified_time" content="2020-06-27T21:57:40+08:00"><meta property="og:site_name" content="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/logo.png"><meta name=twitter:title content="[French FCSC] - Académie"><meta name=twitter:description content="C&rsquo;est la rentrée Bienvenue à l&rsquo;académie de l&rsquo;investigation numérique ! Votre mission, valider un maximum d&rsquo;étapes de cette série afin de démontrer votre dextérité en analyse mémoire GNU/Linux.
Première étape : retrouvez le HOSTNAME, le nom de l&rsquo;utilisateur authentifié lors du dump et la version de Linux sur lequel le dump a été fait.
Format du flag : FCSC{hostname:user:x.x.x-x-amdxx}
TL;DR Cette suite de challenge se base sur le même dump mémoire."><meta name=application-name content="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><meta name=apple-mobile-web-app-title content="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=maki.bzh/writeups/fcscfrench2020academie/><link rel=prev href=maki.bzh/writeups/fcscfrench2020chapardeur/><link rel=stylesheet href=/maki.bzh/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"[French FCSC] - Académie","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"maki.bzh\/writeups\/fcscfrench2020academie\/"},"image":["\/images\/Apple-Devices-Preview.png"],"genre":"writeups","keywords":"anssi, fcsc, forensic, volatility, memory analysis, keepass, chrome","wordcount":9201,"url":"maki.bzh\/writeups\/fcscfrench2020academie\/","datePublished":"2020-06-27T21:57:40+08:00","dateModified":"2020-06-27T21:57:40+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"xxxx","logo":"\/lib\/images\/avatar.png"},"author":{"@type":"Person","name":"Maki"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'dark'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'dark'==='dark')&&document.body.setAttribute('theme','dark')</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=maki.bzh/ title="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><span class=header-title-pre><i class='far fa-kiss-wink-heart fa-fw' aria-hidden=true></i></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/maki.bzh/posts/>Posts </a><a class=menu-item href=/maki.bzh/shorts/>Shorts </a><a class=menu-item href=/maki.bzh/offers/>Offers </a><a class=menu-item href=/maki.bzh/writeups/>Writeups </a><a class=menu-item href=/maki.bzh/tags/>Tags </a><a class=menu-item href=/maki.bzh/about/>About </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=maki.bzh/ title="Maki's adventure | Internet of things, IoT, ICS, forensic, pentest, red team & more :)"><span class=header-title-pre><i class='far fa-kiss-wink-heart fa-fw' aria-hidden=true></i></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/maki.bzh/posts/ title>Posts</a><a class=menu-item href=/maki.bzh/shorts/ title>Shorts</a><a class=menu-item href=/maki.bzh/offers/ title>Offers</a><a class=menu-item href=/maki.bzh/writeups/ title>Writeups</a><a class=menu-item href=/maki.bzh/tags/ title>Tags</a><a class=menu-item href=/maki.bzh/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class="page single special"><h1 class="single-title animate__animated animate__pulse animate__faster">[French FCSC] - Académie</h1><div class=content id=content><h2 id=cest-la-rentrée>C&rsquo;est la rentrée</h2><blockquote><p>Bienvenue à l&rsquo;académie de l&rsquo;investigation numérique ! Votre mission, valider un maximum d&rsquo;étapes de cette série afin de démontrer votre dextérité en analyse mémoire GNU/Linux.</p><p>Première étape : retrouvez le HOSTNAME, le nom de l&rsquo;utilisateur authentifié lors du dump et la version de Linux sur lequel le dump a été fait.</p><p>Format du flag : FCSC{hostname:user:x.x.x-x-amdxx}</p></blockquote><h3 id=tldr>TL;DR</h3><p>Cette suite de challenge se base sur le même dump mémoire. Le premier consiste à se rendre compte que c&rsquo;est un dump Linux.</p><h3 id=état-des-lieux>État des lieux</h3><p>La première chose que je fais sur un dump mémoire pour un challenge, c&rsquo;est de faire deux <code>strings</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  strings dmp.mem &gt; str_dmp.txt 
</span></span><span class=line><span class=cl>➜  strings -e l dmp.mem &gt; str_el_dmp.txt
</span></span></code></pre></td></tr></table></div></div><p>Pour ce challenge, on n’aura pas besoin de plus.</p><h3 id=hostname>Hostname</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  cat str_* <span class=p>|</span> grep <span class=s2>&#34;HOSTNAME=&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>XAUTHLOCALHOSTNAME</span><span class=o>=</span>
</span></span><span class=line><span class=cl><span class=nv>_HOSTNAME</span><span class=o>=</span>challenge.fcsc
</span></span></code></pre></td></tr></table></div></div><blockquote><p>challenge.fcsc</p></blockquote><h3 id=user>User</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  cat str_* <span class=p>|</span> grep -Eo <span class=s2>&#34;^/home/.*/</span>$<span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>/home/Lesage/.mozilla/firefox/peyjyk3f.default-esr/extensions/
</span></span><span class=line><span class=cl>/home/Lesage/.local/share/mime/
</span></span><span class=line><span class=cl>/home/Lesage/.mozilla/firefox/peyjyk3f.default-esr/extensions/
</span></span><span class=line><span class=cl>/home/Lesage/.mozilla/firefox/peyjyk3f.default-esr/extensions/
</span></span><span class=line><span class=cl>/home/Lesage/.local/share/mime/
</span></span><span class=line><span class=cl>/home/Lesage/.local/share/mime/
</span></span><span class=line><span class=cl>/home/Lesage/Documents/temp/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  cat str_* <span class=p>|</span> grep <span class=s2>&#34;USER=&#34;</span> <span class=p>|</span> sort <span class=p>|</span> uniq
</span></span><span class=line><span class=cl><span class=nv>USER</span><span class=o>=</span>Lesage
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Lesage</p></blockquote><h3 id=version-kernel>Version kernel</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  cat str_* <span class=p>|</span> grep <span class=s1>&#39;Linux version&#39;</span> <span class=p>|</span> uniq      
</span></span><span class=line><span class=cl>Linux version 5.4.0-4-amd64 <span class=o>(</span>debian-kernel@lists.debian.org<span class=o>)</span> <span class=o>(</span>gcc version 9.2.1 <span class=m>20200203</span> <span class=o>(</span>Debian 9.2.1-28<span class=o>))</span> <span class=c1>#1 SMP Debian 5.4.19-1 (2020-02-13)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  cat str_* <span class=p>|</span> grep <span class=s2>&#34;BOOT_IMAGE=&#34;</span> 
</span></span><span class=line><span class=cl><span class=nv>BOOT_IMAGE</span><span class=o>=</span>/boot/vmlinuz-5.4.0-4-amd64 <span class=nv>root</span><span class=o>=</span><span class=nv>UUID</span><span class=o>=</span>536c82dd-f1c5-43ce-b65d-c94e5c4a5031 ro quiet
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>5.4.0-4-amd64</p></blockquote><h3 id=flag>Flag</h3><blockquote><p>FCSC{challenge.fcsc:Lesage:5.4.0-4-amd64}</p></blockquote><h2 id=administration>Administration</h2><blockquote><p>Ce poste administre un serveur distant avec le protocole SSH à l&rsquo;aide d&rsquo;une authentification par clé (clé protégée par mot de passe). La clé publique a été utilisée pour chiffrer le message ci-joint (flag.txt.enc).</p><p>Retrouvez et reconstituez la clé en mémoire qui permettra de déchiffrer ce message.</p></blockquote><h3 id=tldr-1>TL;DR</h3><p>Pour ce challenge il n&rsquo;y a pas non plus besoin de générer un profil volatility. En effet, le fichier chiffré a une taille de 2048 bits et l&rsquo;énoncé parle de SSH. Donc on cherche une clé privée RSA, pour cela il existe <code>rsakeyfind</code> qui nous donne &ldquo;d&rdquo; et &ldquo;n&rdquo;. Ces informations permettent de déchiffrer le flag.</p><h3 id=état-de-lart>État de l&rsquo;art</h3><p>On commence le challenge avec un fichier chiffré &ldquo;SSH&rdquo;. Intuitivement, on peut penser à du RSA, mais il existe plusieurs algorithmes disponibles. Pour s&rsquo;en assurer, il suffit de vérifier la taille du fichier chiffré:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  cat flag.txt.enc<span class=p>|</span> wc -c
</span></span><span class=line><span class=cl><span class=m>256</span> <span class=c1># 256*8 = 2048</span>
</span></span></code></pre></td></tr></table></div></div><p>On peut se dire qu&rsquo;on cherche une clé privée RSA.</p><h3 id=récupérer-la-clé-privée>Récupérer la clé privée</h3><p>L&rsquo;outil <code>rsakeyfind</code> : <a href=https://github.com/congwang/rsakeyfind target=_blank rel="noopener noreffer">https://github.com/congwang/rsakeyfind</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  ~/tools/forensic/rsakeyfind/rsakeyfind dmp.mem 
</span></span><span class=line><span class=cl>FOUND PRIVATE KEY AT c64ac50
</span></span><span class=line><span class=cl><span class=nv>version</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=nv>modulus</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> d7 1e <span class=m>77</span> <span class=m>82</span> 8c <span class=m>92</span> <span class=m>31</span> e7 <span class=m>69</span> <span class=m>02</span> a2 d5 5c <span class=m>78</span> de 
</span></span><span class=line><span class=cl>a2 0c 8f fe <span class=m>28</span> <span class=m>59</span> <span class=m>31</span> df <span class=m>40</span> 9c <span class=m>60</span> <span class=m>61</span> <span class=m>06</span> b9 2f <span class=m>62</span> 
</span></span><span class=line><span class=cl><span class=m>40</span> <span class=m>80</span> <span class=m>76</span> cb <span class=m>67</span> 4a b5 <span class=m>59</span> <span class=m>56</span> <span class=m>69</span> <span class=m>17</span> <span class=m>07</span> fa f9 4c bd 
</span></span><span class=line><span class=cl>6c <span class=m>37</span> 7a <span class=m>46</span> 7d <span class=m>70</span> a7 <span class=m>67</span> <span class=m>22</span> b3 4d 7a <span class=m>94</span> c3 ba 4b 
</span></span><span class=line><span class=cl>7c 4b a9 <span class=m>32</span> 7c b7 <span class=m>38</span> <span class=m>95</span> <span class=m>45</span> <span class=m>64</span> a4 <span class=m>05</span> a8 9f <span class=m>12</span> 7c 
</span></span><span class=line><span class=cl>4e c6 c8 2d <span class=m>40</span> <span class=m>06</span> <span class=m>30</span> f4 <span class=m>60</span> a6 <span class=m>91</span> bb 9b ca <span class=m>04</span> <span class=m>79</span> 
</span></span><span class=line><span class=cl><span class=m>11</span> <span class=m>13</span> <span class=m>75</span> f0 ae d3 <span class=m>51</span> <span class=m>89</span> c5 <span class=m>74</span> b9 aa 3f b6 <span class=m>83</span> e4 
</span></span><span class=line><span class=cl><span class=m>78</span> 6b <span class=nb>cd</span> f9 5c 4c <span class=m>85</span> ea <span class=m>52</span> 3b <span class=m>51</span> <span class=m>93</span> <span class=nb>fc</span> <span class=m>14</span> 6b <span class=m>33</span> 
</span></span><span class=line><span class=cl>5d <span class=m>30</span> <span class=m>70</span> fa <span class=m>50</span> 1b 1b <span class=m>38</span> <span class=m>81</span> <span class=m>13</span> 8d f7 a5 0c c0 8e 
</span></span><span class=line><span class=cl>f9 <span class=m>63</span> <span class=m>52</span> <span class=m>18</span> 4e a9 f9 f8 5c 5d <span class=nb>cd</span> 7a 0d d4 8e 7b 
</span></span><span class=line><span class=cl>ee <span class=m>91</span> 7b ad 7d b4 <span class=m>92</span> d5 ab <span class=m>16</span> 3b 0a 8a ce 8e de 
</span></span><span class=line><span class=cl><span class=m>47</span> 1a <span class=m>17</span> <span class=m>01</span> <span class=m>86</span> 7b ab <span class=m>99</span> f1 4b 0c 3a 0d <span class=m>82</span> <span class=m>47</span> c1 
</span></span><span class=line><span class=cl><span class=m>91</span> 8c bb 2e <span class=m>22</span> 9e <span class=m>49</span> <span class=m>63</span> 6e <span class=m>02</span> c1 c9 3a 9b a5 <span class=m>22</span> 
</span></span><span class=line><span class=cl>1b <span class=m>07</span> <span class=m>95</span> d6 <span class=m>10</span> <span class=m>02</span> <span class=m>50</span> fd fd d1 9b be ab c2 c0 <span class=m>74</span> 
</span></span><span class=line><span class=cl>d7 ec <span class=m>00</span> fb <span class=m>11</span> <span class=m>71</span> cb 7a dc <span class=m>81</span> <span class=m>79</span> 9f <span class=m>86</span> <span class=m>68</span> <span class=m>46</span> <span class=m>63</span> 
</span></span><span class=line><span class=cl><span class=m>82</span> 4d b7 f1 e6 <span class=m>16</span> 6f <span class=m>42</span> <span class=m>63</span> f4 <span class=m>94</span> a0 ca <span class=m>33</span> cc <span class=m>75</span> 
</span></span><span class=line><span class=cl><span class=m>13</span> 
</span></span><span class=line><span class=cl><span class=nv>publicExponent</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>01</span> <span class=m>00</span> <span class=m>01</span> 
</span></span><span class=line><span class=cl><span class=nv>privateExponent</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=m>62</span> b5 <span class=m>60</span> <span class=m>31</span> 4f 3f <span class=m>66</span> <span class=m>16</span> c1 <span class=m>60</span> ac <span class=m>47</span> 2a ff 6b <span class=m>69</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> 4a b2 5c e1 <span class=m>50</span> b9 <span class=m>18</span> <span class=m>74</span> a8 e4 dc a8 ec <span class=nb>cd</span> <span class=m>30</span> 
</span></span><span class=line><span class=cl>bb c1 c6 e3 c6 ac <span class=m>20</span> 2a 3e 5e 8b <span class=m>12</span> e6 <span class=m>82</span> <span class=m>08</span> <span class=m>09</span> 
</span></span><span class=line><span class=cl><span class=m>38</span> 0b ab 7c b3 cc 9c ce <span class=m>97</span> <span class=m>67</span> dd ef <span class=m>95</span> <span class=m>40</span> 4e <span class=m>92</span> 
</span></span><span class=line><span class=cl>e2 <span class=m>44</span> e9 1d c1 <span class=m>14</span> fd a9 b1 dc <span class=m>71</span> 9c <span class=m>46</span> <span class=m>21</span> bd <span class=m>58</span> 
</span></span><span class=line><span class=cl><span class=m>88</span> 6e <span class=m>22</span> <span class=m>15</span> <span class=m>56</span> c1 ef e0 c9 8d e5 <span class=m>80</span> 3e da 7e <span class=m>93</span> 
</span></span><span class=line><span class=cl>0f <span class=m>52</span> f6 f5 c1 <span class=m>91</span> <span class=m>90</span> 9e <span class=m>42</span> <span class=m>49</span> 4f 8d 9c ba <span class=m>38</span> <span class=m>83</span> 
</span></span><span class=line><span class=cl>e9 <span class=m>33</span> c2 <span class=m>50</span> 4f ec c2 f0 a8 b7 6e <span class=m>28</span> <span class=m>25</span> <span class=m>56</span> 6b <span class=m>62</span> 
</span></span><span class=line><span class=cl><span class=m>67</span> fe <span class=m>08</span> f1 <span class=m>56</span> e5 6f 0e <span class=m>99</span> f1 e5 <span class=m>95</span> 7b ef eb 0a 
</span></span><span class=line><span class=cl>2c <span class=m>92</span> <span class=m>97</span> <span class=m>57</span> <span class=m>23</span> <span class=m>33</span> <span class=m>36</span> <span class=m>07</span> dd fb ae f1 b1 d8 <span class=m>33</span> b7 
</span></span><span class=line><span class=cl><span class=m>96</span> <span class=m>71</span> <span class=m>42</span> <span class=m>36</span> c5 a4 a9 <span class=m>19</span> 4b 1b <span class=m>52</span> 4c <span class=m>50</span> <span class=m>69</span> <span class=m>91</span> f0 
</span></span><span class=line><span class=cl>0e fa <span class=m>80</span> <span class=m>37</span> 4b b5 d0 2f b7 <span class=m>44</span> 0d d4 f8 <span class=m>39</span> 8d ab 
</span></span><span class=line><span class=cl><span class=m>71</span> <span class=m>67</span> <span class=m>59</span> <span class=m>05</span> <span class=m>88</span> 3d eb <span class=m>48</span> <span class=m>48</span> <span class=m>33</span> <span class=m>88</span> 4e fe f8 <span class=m>27</span> 1b 
</span></span><span class=line><span class=cl>d6 <span class=m>55</span> <span class=m>60</span> 5e <span class=m>48</span> b7 6d 9a a8 <span class=m>37</span> f9 7a de 1b <span class=nb>cd</span> 5d 
</span></span><span class=line><span class=cl>1a <span class=m>30</span> d4 e9 9e 5b 3c <span class=m>15</span> f8 9c 1f da d1 <span class=m>86</span> <span class=m>48</span> <span class=m>55</span> 
</span></span><span class=line><span class=cl>ce <span class=m>83</span> ee 8e <span class=m>51</span> c7 de <span class=m>32</span> <span class=m>12</span> <span class=m>47</span> 7d <span class=m>46</span> b8 <span class=m>35</span> df <span class=m>41</span> 
</span></span><span class=line><span class=cl><span class=nv>prime1</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=nv>prime2</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=nv>exponent1</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=nv>exponent2</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> 
</span></span><span class=line><span class=cl><span class=nv>coefficient</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=m>00</span> 
</span></span></code></pre></td></tr></table></div></div><h3 id=déchiffrer-le-fichier>Déchiffrer le fichier</h3><p>Il suffit d&rsquo;utiliser &rsquo;d&rsquo;, &rsquo;n&rsquo; et le fichier &ldquo;flag.txt.enc&rdquo; pour récupérer le flag:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  cat flag.txt.enc <span class=p>|</span> xxd -p <span class=p>|</span> tr -d <span class=s1>&#39;\n&#39;</span>
</span></span><span class=line><span class=cl>6da249ada8a979ed289b249d9ed4af472bda2ebbd1d9ea8b63f927f9bf91ba1bb76c378e6e62f07b7717f1e1def03dd65a8c6ee3ce40447d12f7b07ad2d18256a3997bd5786cccfaa678b1f60b069e6b8ccc70eb6948c3624eaf7832727bd034c9964c7dd863830d3b07bc4b242c4fe0ead36ae7a81ff1419b658b86dd30d78acc797f5b7a2b5c08d3fc807fbcd9e61e7f46071cdc3906882b9084e9af9231c4b343fbac2349232d368b0d343f6e9e2c7ff32242e1885590fdfe762ce8658c684c04ea19b8bf7b5153c4a4cdfbd5847da3b53fc285469b7761a5da6f1778b8972da6006d279a8042bbfaa7045ec72bf778f24d6da5fe1fde422667bc9c53f77d
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=mh>0xd71e77828c9231e76902a2d55c78dea20c8ffe285931df409c606106b92f62408076cb674ab55956691707faf94cbd6c377a467d70a76722b34d7a94c3ba4b7c4ba9327cb738954564a405a89f127c4ec6c82d400630f460a691bb9bca0479111375f0aed35189c574b9aa3fb683e4786bcdf95c4c85ea523b5193fc146b335d3070fa501b1b3881138df7a50cc08ef96352184ea9f9f85c5dcd7a0dd48e7bee917bad7db492d5ab163b0a8ace8ede471a1701867bab99f14b0c3a0d8247c1918cbb2e229e49636e02c1c93a9ba5221b0795d6100250fdfdd19bbeabc2c074d7ec00fb1171cb7adc81799f86684663824db7f1e6166f4263f494a0ca33cc7513</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=mh>0x62b560314f3f6616c160ac472aff6b69004ab25ce150b91874a8e4dca8eccd30bbc1c6e3c6ac202a3e5e8b12e6820809380bab7cb3cc9cce9767ddef95404e92e244e91dc114fda9b1dc719c4621bd58886e221556c1efe0c98de5803eda7e930f52f6f5c191909e42494f8d9cba3883e933c2504fecc2f0a8b76e2825566b6267fe08f156e56f0e99f1e5957befeb0a2c92975723333607ddfbaef1b1d833b796714236c5a4a9194b1b524c506991f00efa80374bb5d02fb7440dd4f8398dab71675905883deb484833884efef8271bd655605e48b76d9aa837f97ade1bcd5d1a30d4e99e5b3c15f89c1fdad1864855ce83ee8e51c7de3212477d46b835df41</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=mh>0x6da249ada8a979ed289b249d9ed4af472bda2ebbd1d9ea8b63f927f9bf91ba1bb76c378e6e62f07b7717f1e1def03dd65a8c6ee3ce40447d12f7b07ad2d18256a3997bd5786cccfaa678b1f60b069e6b8ccc70eb6948c3624eaf7832727bd034c9964c7dd863830d3b07bc4b242c4fe0ead36ae7a81ff1419b658b86dd30d78acc797f5b7a2b5c08d3fc807fbcd9e61e7f46071cdc3906882b9084e9af9231c4b343fbac2349232d368b0d343f6e9e2c7ff32242e1885590fdfe762ce8658c684c04ea19b8bf7b5153c4a4cdfbd5847da3b53fc285469b7761a5da6f1778b8972da6006d279a8042bbfaa7045ec72bf778f24d6da5fe1fde422667bc9c53f77d</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c</span><span class=p>,</span><span class=n>d</span><span class=p>,</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>hex</span><span class=p>(</span><span class=n>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Output : 0x22681c036dd635f46c2853e08b7359b196e5db09f3fa40a801704b36f7408c8ed931f29ff4319a7ba0be6e107624a43471d49cc14bb0e71488c76230de112bb05f7821bc81f67db4c80fd038938bfc7fed1e963b3e9adb27bd127948b1d9bb3874b1bc320e90628a991bc066dc4406830133627cb148370d14d9538ff238d12f002bc89233daa0beda1ca2c5bc714087ef808624e5b4ed1e9b62bb6f6a34c88907381f1606de98951ba3733bf8d426e310417b61e394300464353437b616335636164363631313464343836366134623535653433636238383936636334393437383535323431623561663864326638613132336333363038336439387d0a</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  <span class=nb>echo</span> -n <span class=s1>&#39;022681c036dd635f46c2853e08b7359b196e5db09f3fa40a801704b36f7408c8ed931f29ff4319a7ba0be6e107624a43471d49cc14bb0e71488c76230de112bb05f7821bc81f67db4c80fd038938bfc7fed1e963b3e9adb27bd127948b1d9bb3874b1bc320e90628a991bc066dc4406830133627cb148370d14d9538ff238d12f002bc89233daa0beda1ca2c5bc714087ef808624e5b4ed1e9b62bb6f6a34c88907381f1606de98951ba3733bf8d426e310417b61e394300464353437b616335636164363631313464343836366134623535653433636238383936636334393437383535323431623561663864326638613132336333363038336439387d0a&#39;</span> <span class=p>|</span> xxd -r -p <span class=p>|</span> strings -n <span class=m>10</span>
</span></span><span class=line><span class=cl>FCSC<span class=o>{</span>ac5cad66114d4866a4b55e43cb8896cc4947855241b5af8d2f8a123c36083d98<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=flag-1>Flag</h3><blockquote><p>FCSC{ac5cad66114d4866a4b55e43cb8896cc4947855241b5af8d2f8a123c36083d98}</p></blockquote><hr><h2 id=premiers-artéfacts>Premiers artéfacts</h2><blockquote><p>Pour avancer dans l&rsquo;analyse, vous devez retrouver :</p><ul><li>Le nom de processus ayant le PID 1254.</li><li>La commande exacte qui a été exécutée le 2020-03-26 23:29:19 UTC.</li><li>Le nombre d&rsquo;IP-DST unique en communications TCP établies (état ESTABLISHED) lors du dump.</li></ul><p>Format du flag : FCSC{nom_du_processus:une_commande:n}</p></blockquote><h3 id=tldr-2>TL;DR</h3><p>Ce challenge va nécessiter le profil Linux associé. Pour cela on se sert des snapshot Debian de Sid à la bonne date pour récupérer le bon kernel. Une fois le profil généré, il suffit d&rsquo;utiliser les plugins linux_psscan, linux_bash et linux_netscan.</p><h3 id=état-de-lart-1>État de l&rsquo;art</h3><p>Ce challenge annonce le début des ennuis. En effet, il va falloir créer un profil volatility pour pouvoir récupérer ces informations. En temps normal, créer un profil sur un Debian, c&rsquo;est plutôt très simple (cf. Un poc en bash d&rsquo;automatisation que j&rsquo;avais fait : <a href=https://github.com/Zeecka/Auto_vol%29 target=_blank rel="noopener noreffer">https://github.com/Zeecka/Auto_vol)</a>.</p><p>Le souci principal va être de trouver la bonne version de Kernel. Grâce au challenge précédent, on sait que le kernel est de version : <strong>5.4.0-4-amd64</strong>. Qui dit très récent, va dire très casse-pied.</p><h3 id=génération-du-profil>Génération du profil</h3><p>La version est:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  cat str_* <span class=p>|</span> grep <span class=s1>&#39;Linux version&#39;</span> <span class=p>|</span> uniq      
</span></span><span class=line><span class=cl>Linux version 5.4.0-4-amd64 <span class=o>(</span>debian-kernel@lists.debian.org<span class=o>)</span> <span class=o>(</span>gcc version 9.2.1 <span class=m>20200203</span> <span class=o>(</span>Debian 9.2.1-28<span class=o>))</span> <span class=c1>#1 SMP Debian 5.4.19-1 (2020-02-13)</span>
</span></span></code></pre></td></tr></table></div></div><p>Deux informations intéressantes:</p><ul><li>Kernel : 5.4.0-4-amd64</li><li>Date : 2020-02-13</li></ul><p>Avec cette date, il est possible de trouver un snapshot précis des dépôts Debian sur : <a href=https://snapshot.debian.org/ target=_blank rel="noopener noreffer">https://snapshot.debian.org/</a></p><p>La première étape est de créer une VM Debian: <a href=https://cdimage.debian.org/debian-cd/current/amd64/bt-cd/debian-10.3.0-amd64-netinst.iso.torrent target=_blank rel="noopener noreffer">https://cdimage.debian.org/debian-cd/current/amd64/bt-cd/debian-10.3.0-amd64-netinst.iso.torrent</a></p><p>Lorsque la machine est installée, un simple <code>uname -a</code> montre qu&rsquo;on a pas du tout la bonne version de kernel. C&rsquo;est là que les snapshots Debian seront utiles. Avec un peu de recherche, on trouve ces dépôts:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>deb <span class=o>[</span>check-valid-until<span class=o>=</span>no<span class=o>]</span> https://snapshot.debian.org/archive/debian/20200213T231921Z/ sid main contrib non-free
</span></span><span class=line><span class=cl>deb-src <span class=o>[</span>check-valid-until<span class=o>=</span>no<span class=o>]</span> https://snapshot.debian.org/archive/debian/20200213T231921Z/ sid main contrib non-free
</span></span></code></pre></td></tr></table></div></div><p>Donc en l&rsquo;ajoutant dans notre <strong>/etc/apt/sources.list</strong>, on peut faire une recherche, et là:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>user@debian:~$ apt search linux-headers
</span></span><span class=line><span class=cl>En train de trier... Fait
</span></span><span class=line><span class=cl>Recherche en texte intégral... Fait
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>linux-headers-5.4.0-4-amd64/unstable,now 5.4.19-1 amd64  
</span></span><span class=line><span class=cl>  Header files <span class=k>for</span> Linux 5.4.0-4-amd64
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>user@debian:~$ apt search linux-image
</span></span><span class=line><span class=cl>En train de trier... Fait
</span></span><span class=line><span class=cl>Recherche en texte intégral... Fait
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>linux-image-5.4.0-4-amd64-unsigned/unstable,now 5.4.19-1 amd64  
</span></span><span class=line><span class=cl>  Linux 5.4 <span class=k>for</span> 64-bit PCs
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p>Oook boy, il est temps d&rsquo;installer ce qu&rsquo;il nous faut:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@debian:/home/user# apt install linux-headers-5.4.0-4-amd64 linux-image-5.4.0-4-amd64-unsigned volatility-tools
</span></span></code></pre></td></tr></table></div></div><p>Une fois le tout installé, il faut redémarrer la machine et boot sur le bon kernel (grub est plutôt intuitif pour ça):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>user@debian:~$ uname -a
</span></span><span class=line><span class=cl>Linux debian 5.4.0-4-amd64 <span class=c1>#1 SMP Debian 5.4.19-1 (2020-02-13) x86_64 GNU/Linux</span>
</span></span></code></pre></td></tr></table></div></div><p>Ca a une bonne tête. Il est temps de créer le profil (cf. <a href=https://www.maki.bzh/walkthrough/santhacklaus2018/#mission-impossible-1%29 target=_blank rel="noopener noreffer">https://www.maki.bzh/walkthrough/santhacklaus2018/#mission-impossible-1)</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@debian:/home/user# <span class=nb>cd</span> /usr/src/volatility-tools/linux/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@debian:/usr/src/volatility-tools/linux# make
</span></span><span class=line><span class=cl><span class=o>[</span>...BLABLABLA MAKE BLABLALBA<span class=o>]</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>root@debian:/usr/src/volatility-tools/linux# zip ecsc_deb540.zip /usr/src/volatility-tools/linux/module.dwarf /boot/System.map-5.4.0-4-amd64 
</span></span><span class=line><span class=cl>  adding: usr/src/volatility-tools/linux/module.dwarf <span class=o>(</span>deflated 91%<span class=o>)</span>
</span></span><span class=line><span class=cl>  adding: boot/System.map-5.4.0-4-amd64 <span class=o>(</span>deflated 79%<span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Aller maintenant on le met dans un dossier accessible par volatility (j&rsquo;utilise volatility en docker, pour être sur que les dépendances pètent pas, genre yara: <a href=https://github.com/makim0n/infosec-docker/tree/master/forensic/volatility%29 target=_blank rel="noopener noreffer">https://github.com/makim0n/infosec-docker/tree/master/forensic/volatility)</a>.</p><p>Donc j&rsquo;ai mis le profil <strong>ecsc_deb540.zip</strong> dans le dossier de <strong>/opt/plug_vol</strong> de mon docker:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --info <span class=p>|</span> grep ecsc
</span></span><span class=line><span class=cl>Linuxecsc_deb540x64                      - A Profile <span class=k>for</span> Linux ecsc_deb540 x64
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Linuxecsc_deb540x64</p></blockquote><p>Aller, c&rsquo;est le moment le plus stressant: faut tester que ça marche.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_banner
</span></span><span class=line><span class=cl>Linux version 5.4.0-4-amd64 <span class=o>(</span>debian-kernel@lists.debian.org<span class=o>)</span> <span class=o>(</span>gcc version 9.2.1 <span class=m>20200203</span> <span class=o>(</span>Debian 9.2.1-28<span class=o>))</span> <span class=c1>#1 SMP Debian 5.4.19-1 (2020-02-13)</span>
</span></span></code></pre></td></tr></table></div></div><img src=https://media.giphy.com/media/S5fMUcgKUs04E/giphy.gif><h3 id=nom-du-processus-1254>Nom du processus 1254</h3><p>Maintenant que le profil est créé, en temps normal je fais un <code>linux_pstree</code>, mais ici ça ne semble pas aider beaucoup:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_pstree &gt; /opt/usr_land/linux_pstree 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  cat linux_pstree<span class=p>|</span> grep <span class=m>1254</span>
</span></span><span class=line><span class=cl><span class=c1># Pas de retour, c&#39;est fâcheux.</span>
</span></span></code></pre></td></tr></table></div></div><p>Donc là, pas le choix, on sort la doc: <a href=https://github.com/volatilityfoundation/volatility/wiki/Linux-Command-Reference target=_blank rel="noopener noreffer">https://github.com/volatilityfoundation/volatility/wiki/Linux-Command-Reference</a></p><p>On voit le plugin <code>linux_psslit</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_pslist &gt; /opt/usr_land/pslist 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  cat pslist<span class=p>|</span> grep <span class=m>1254</span>
</span></span><span class=line><span class=cl><span class=c1># Pas de retour encore une fois, c&#39;est fâcheux.</span>
</span></span></code></pre></td></tr></table></div></div><p>Je me rappelle ce qu&rsquo;un ancien collègue et sensei du forensic (<a href=https://twitter.com/AZobec target=_blank rel="noopener noreffer">@AZobec</a> &lt;3) m&rsquo;avais dit:</p><blockquote><p>Volatility c&rsquo;est bien, mais la doc c&rsquo;est le code, donc creuse quand tu trouves pas</p></blockquote><p>Donc on part pour le github de volatility dans le dossier des plugins: <a href=https://github.com/volatilityfoundation/volatility/tree/master/volatility/plugins/linux target=_blank rel="noopener noreffer">https://github.com/volatilityfoundation/volatility/tree/master/volatility/plugins/linux</a></p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/27gbkDA.png data-srcset="https://i.imgur.com/27gbkDA.png, https://i.imgur.com/27gbkDA.png 1.5x, https://i.imgur.com/27gbkDA.png 2x" data-sizes=auto alt=https://i.imgur.com/27gbkDA.png title=https://i.imgur.com/27gbkDA.png></p><p>Ce plugin n&rsquo;est pas du tout présent dans la command reference.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_psscan &gt; /opt/usr_land/psscan 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  cat psscan<span class=p>|</span> grep <span class=m>1254</span>
</span></span><span class=line><span class=cl>0x000000003fdccd80 pool-xfconfd         <span class=m>1254</span>            -               -1              -1     0x0fd08ee88ee08ec0 -
</span></span></code></pre></td></tr></table></div></div><p>Enfin:</p><blockquote><p>pool-xfconfd</p></blockquote><h3 id=la-commande-exécutée>La commande exécutée</h3><p>Les commandes exécutées par l&rsquo;utilisateur sont plus simples à trouver:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_bash &gt; /opt/usr_land/linux_bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  cat linux_bash 
</span></span><span class=line><span class=cl>Pid      Name                 Command Time                   Command
</span></span><span class=line><span class=cl>-------- -------------------- ------------------------------ -------
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=m>1523</span> bash                 2020-03-26 23:29:19 UTC+0000   nmap -sS -sV 10.42.42.0/24
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>nmap -sS -sV 10.42.42.0/24</p></blockquote><p>D&rsquo;ailleurs, quitte à rester dans &ldquo;la doc c&rsquo;est le code&rdquo;, il existe des arguments pour les plugins volatility, qui ne sont pas forcément documentés:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/jrVDpiG.png data-srcset="https://i.imgur.com/jrVDpiG.png, https://i.imgur.com/jrVDpiG.png 1.5x, https://i.imgur.com/jrVDpiG.png 2x" data-sizes=auto alt=https://i.imgur.com/jrVDpiG.png title=https://i.imgur.com/jrVDpiG.png></p><blockquote><p><a href=https://github.com/volatilityfoundation/volatility/blob/master/volatility/plugins/linux/bash.py target=_blank rel="noopener noreffer">https://github.com/volatilityfoundation/volatility/blob/master/volatility/plugins/linux/bash.py</a></p></blockquote><p>Ici, ça ne sert à rien, mais c&rsquo;est bon à savoir.</p><h3 id=nombre-de-connexion>Nombre de connexion</h3><p>Pour le nombre de connexions, on sait que ce sont les connexions &ldquo;établies&rdquo;. Avec mon super niveau en anglais, &ldquo;Peer connections&rdquo; j&rsquo;étais pas sur de ce que c&rsquo;était, mais la commande <code>ss</code> de mon système m&rsquo;a aidée:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  ss <span class=p>|</span> head -n <span class=m>2</span>
</span></span><span class=line><span class=cl>Netid            State                  Recv-Q              Send-Q                                                                                Local Address:Port                                         Peer Address:Port                  
</span></span><span class=line><span class=cl>u_str            ESTAB                  <span class=m>0</span>                   <span class=m>0</span>                                                                                                 * <span class=m>178269</span>                                                  * <span class=m>180308</span>                
</span></span></code></pre></td></tr></table></div></div><p>Ce sont donc les adresses de destinations. Il existe un plugin pour lister les connexions lors du dump: <code>linux_netscan</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_netscan &gt; /opt/usr_land/netscan
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  cat netscan <span class=p>|</span> grep ESTA
</span></span><span class=line><span class=cl>9d72830a8000 TCP      10.42.42.131    :58772 185.199.111.154 :  <span class=m>443</span> ESTABLISHED    
</span></span><span class=line><span class=cl>9d72830a88c0 TCP      10.42.42.131    :45652 35.190.72.21    :  <span class=m>443</span> ESTABLISHED    
</span></span><span class=line><span class=cl>9d72830a9a40 TCP      10.42.42.131    :53190 104.124.192.89  :  <span class=m>443</span> ESTABLISHED    
</span></span><span class=line><span class=cl>9d72830abd40 TCP      10.42.42.131    :55226 151.101.121.140 :  <span class=m>443</span> ESTABLISHED    
</span></span><span class=line><span class=cl>9d72830ad780 TCP      10.42.42.131    :50612 104.93.255.199  :  <span class=m>443</span> ESTABLISHED    
</span></span><span class=line><span class=cl>9d72830af1c0 TCP      10.42.42.131    :38184 216.58.213.142  :  <span class=m>443</span> ESTABLISHED    
</span></span><span class=line><span class=cl>9d7284eba300 TCP      10.42.42.131    :37252 163.172.182.147 :  <span class=m>443</span> ESTABLISHED    
</span></span><span class=line><span class=cl>9d7284fe9180 TCP      127.0.0.1       :38498 127.0.0.1       :34243 ESTABLISHED    
</span></span><span class=line><span class=cl>9d7284fe9a40 TCP      10.42.42.131    :57000 10.42.42.134    :   <span class=m>22</span> ESTABLISHED    
</span></span><span class=line><span class=cl>9d7284feb480 TCP      10.42.42.131    :51858 10.42.42.128    :  <span class=m>445</span> ESTABLISHED    
</span></span><span class=line><span class=cl>9d7284fef1c0 TCP      10.42.42.131    :55224 151.101.121.140 :  <span class=m>443</span> ESTABLISHED    
</span></span><span class=line><span class=cl>9d7293778000 TCP      10.42.42.131    :47100 216.58.206.226  :  <span class=m>443</span> ESTABLISHED    
</span></span><span class=line><span class=cl>9d729377cec0 TCP      10.42.42.131    :47106 216.58.206.226  :  <span class=m>443</span> ESTABLISHED    
</span></span><span class=line><span class=cl>9d72c0acb480 TCP      10.42.42.131    :36970 116.203.52.118  :  <span class=m>443</span> ESTABLISHED    
</span></span><span class=line><span class=cl>9d72c1503d40 TCP      127.0.0.1       :34243 127.0.0.1       :38498 ESTABLISHED    
</span></span><span class=line><span class=cl>9d72c1bc1280 TCP      fd:6663:7363:1000:c10b:6374:25f:dc37:36280 fd:6663:7363:1000:55cf:b9c6:f41d:cc24:58014 ESTABLISHED    
</span></span><span class=line><span class=cl>9d72c23fcec0 TCP      10.42.42.131    :38186 216.58.213.142  :  <span class=m>443</span> ESTABLISHED    
</span></span><span class=line><span class=cl>9d72c23fe040 TCP      10.42.42.131    :47104 216.58.206.226  :  <span class=m>443</span> ESTABLISHED    
</span></span><span class=line><span class=cl>9d72c23fe900 TCP      10.42.42.131    :47102 216.58.206.226  :  <span class=m>443</span> ESTABLISHED    
</span></span></code></pre></td></tr></table></div></div><p>Avec un peu de formating pour garder uniquement les IPs sortantes, on tombe sur:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  <span class=nb>echo</span> -n <span class=s1>&#39;185.199.111.154     
</span></span></span><span class=line><span class=cl><span class=s1>35.190.72.21        
</span></span></span><span class=line><span class=cl><span class=s1>104.124.192.89      
</span></span></span><span class=line><span class=cl><span class=s1>151.101.121.140     
</span></span></span><span class=line><span class=cl><span class=s1>104.93.255.199      
</span></span></span><span class=line><span class=cl><span class=s1>216.58.213.142      
</span></span></span><span class=line><span class=cl><span class=s1>163.172.182.147     
</span></span></span><span class=line><span class=cl><span class=s1>127.0.0.1           
</span></span></span><span class=line><span class=cl><span class=s1>10.42.42.134        
</span></span></span><span class=line><span class=cl><span class=s1>10.42.42.128        
</span></span></span><span class=line><span class=cl><span class=s1>151.101.121.140     
</span></span></span><span class=line><span class=cl><span class=s1>216.58.206.226      
</span></span></span><span class=line><span class=cl><span class=s1>216.58.206.226      
</span></span></span><span class=line><span class=cl><span class=s1>116.203.52.118      
</span></span></span><span class=line><span class=cl><span class=s1>127.0.0.1           
</span></span></span><span class=line><span class=cl><span class=s1>216.58.213.142      
</span></span></span><span class=line><span class=cl><span class=s1>216.58.206.226      
</span></span></span><span class=line><span class=cl><span class=s1>216.58.206.226      
</span></span></span><span class=line><span class=cl><span class=s1>fd:6663:7363:1000:55cf:b9c6:f41d:cc24:58014    
</span></span></span><span class=line><span class=cl><span class=s1>&#39;</span> <span class=p>|</span> tr -d <span class=s1>&#39; &#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq <span class=p>|</span> wc -l
</span></span><span class=line><span class=cl><span class=m>13</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>13</p></blockquote><h3 id=flag-2>Flag</h3><p>Challenge enfin terminé.</p><blockquote><p>FCSC{pool-xfconfd:nmap -sS -sV 10.42.42.0/24:13}</p></blockquote><hr><h2 id=porte-dérobée>Porte dérobée</h2><blockquote><p>Un poste distant est connecté au poste en cours d&rsquo;analyse via une porte dérobée avec la capacité d&rsquo;exécuter des commandes.</p><ul><li>Quel est le numéro de port à l&rsquo;écoute de cette connexion ?</li><li>Quelle est l&rsquo;adresse IP distante connectée au moment du dump ?</li><li>Quel est l&rsquo;horodatage de la création du processus en UTC de cette porte dérobée ?</li></ul><p>Format du flag : FCSC{port:IP:YYYY-MM-DD HH:MM:SS}</p></blockquote><h3 id=tldr-3>TL;DR</h3><p>Ce challenge est dans la continuité du précédent sur l&rsquo;analyse du dump. Grâce à <code>linux_netscan</code>, il est possible de voir des processus suspects. Ensuite, <code>linux_pstree</code> permet de s&rsquo;en assurer. Enfin, l&rsquo;horodatage est trouvable grâce à <code>linux_pslist</code>.</p><h3 id=état-des-lieux-1>État des lieux</h3><p>Ce challenge est aussi de l&rsquo;analyse plutôt basique d&rsquo;un dump mémoire. Dans le challenge précédant, on commence par utiliser le plugin <code>linux_netstat</code>, par défaut il va aussi afficher les sockets unix, on n’y reprendra pas, allons voir le code:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/IUhlkTX.png data-srcset="https://i.imgur.com/IUhlkTX.png, https://i.imgur.com/IUhlkTX.png 1.5x, https://i.imgur.com/IUhlkTX.png 2x" data-sizes=auto alt=https://i.imgur.com/IUhlkTX.png title=https://i.imgur.com/IUhlkTX.png></p><blockquote><p><a href=https://github.com/volatilityfoundation/volatility/blob/master/volatility/plugins/linux/netstat.py target=_blank rel="noopener noreffer">https://github.com/volatilityfoundation/volatility/blob/master/volatility/plugins/linux/netstat.py</a></p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_netstat -U &gt; /opt/usr_land/netstat_wo_socketunix
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  cat netstat_wo_socketunix
</span></span><span class=line><span class=cl>➜  cestlarentree cat netstat_wo_socketunix <span class=p>|</span> grep ESTA
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>TCP      fd:6663:7363:1000:c10b:6374:25f:dc37:36280 fd:6663:7363:1000:55cf:b9c6:f41d:cc24:58014 ESTABLISHED                  ncat/1515 
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>TCP      fd:6663:7363:1000:c10b:6374:25f:dc37:36280 fd:6663:7363:1000:55cf:b9c6:f41d:cc24:58014 ESTABLISHED                    sh/119511
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p>En vrai, je suis pas un expert, mais un <strong>ncat</strong> et un <strong>sh</strong>&mldr; Mon petit passif de pentester me dit que ça sent pas bon.</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://media.giphy.com/media/3oEdv8EdOATmWJDCNO/giphy.gif data-srcset="https://media.giphy.com/media/3oEdv8EdOATmWJDCNO/giphy.gif, https://media.giphy.com/media/3oEdv8EdOATmWJDCNO/giphy.gif 1.5x, https://media.giphy.com/media/3oEdv8EdOATmWJDCNO/giphy.gif 2x" data-sizes=auto alt=https://media.giphy.com/media/3oEdv8EdOATmWJDCNO/giphy.gif title=https://media.giphy.com/media/3oEdv8EdOATmWJDCNO/giphy.gif></p><h3 id=port-en-écoute>Port en écoute</h3><p>En remontant cette piste, il est simple de trouver les informations que l&rsquo;on cherche:</p><blockquote><p>36280</p></blockquote><h3 id=ip-distante-connectée>IP distante connectée</h3><p>L&rsquo;IP distante aussi est donnée:</p><blockquote><p>fd:6663:7363:1000:55cf:b9c6:f41d:cc24</p></blockquote><h3 id=horodatage>Horodatage</h3><p>Pour l&rsquo;horodatage, on a le PID du <strong>ncat</strong> et du <strong>sh</strong>. Avec <code>linux_pstree</code> il est possible de voir le processus parent facilement:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_pstree &gt; /opt/usr_land/linux_pstree
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  cat linux_pstree 
</span></span><span class=line><span class=cl>Name                 Pid             Uid            
</span></span><span class=line><span class=cl>systemd              <span class=m>1</span>                              
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>.x-terminal-emul     <span class=m>1503</span>            <span class=m>1001</span>           
</span></span><span class=line><span class=cl>..bash               <span class=m>1513</span>            <span class=m>1001</span>           
</span></span><span class=line><span class=cl>...ncat              <span class=m>1515</span>            <span class=m>1001</span>           
</span></span><span class=line><span class=cl>....sh               <span class=m>119511</span>          <span class=m>1001</span>           
</span></span></code></pre></td></tr></table></div></div><p>En remontant sur le processus parent <strong>bash</strong>, la date est donc:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_pslist -p <span class=m>1513</span>
</span></span><span class=line><span class=cl>Offset             Name                 Pid             PPid            Uid             Gid    DTB                Start Time
</span></span><span class=line><span class=cl>------------------ -------------------- --------------- --------------- --------------- ------ ------------------ ----------
</span></span><span class=line><span class=cl>0xffff9d72c014dd00 bash                 <span class=m>1513</span>            <span class=m>1503</span>            <span class=m>1001</span>            <span class=m>1001</span>   0x000000004012c000 2020-03-26 23:24:20 UTC+0000
</span></span></code></pre></td></tr></table></div></div><blockquote><p>2020-03-26 23:24:20</p></blockquote><h3 id=flag-3>Flag</h3><blockquote><p>FCSC{36280:fd:6663:7363:1000:55cf:b9c6:f41d:cc24:2020-03-26 23:24:20}</p></blockquote><hr><h2 id=rédaction>Rédaction</h2><blockquote><p>Le document note.docx vient d&rsquo;être créé avec LibreOffice et enregistré avant le dump de la mémoire. Retrouvez son contenu !</p><p>Format du flag : FCSC{xxx}, où xxx est la chaîne qui vous sera indiquée à la lecture du contenu du document.</p></blockquote><h3 id=tldr-4>TL;DR</h3><p>Ce challenge consiste à récupérer le contenu d&rsquo;un fichier &ldquo;docx&rdquo;. En sachant que c&rsquo;est un docx, il est possible d&rsquo;en créer un local, le décompresser et chercher la structure de &ldquo;document.xml&rdquo; en mémoire et ainsi trouver le flag.</p><h3 id=état-des-lieux-2>État des lieux</h3><p>Pour ce challenge, on sait qu&rsquo;on cherche un fichier <strong>docx</strong> et que l&rsquo;utilisateur a utilisé <strong>LibreOffice</strong>. La grosse erreur est que je n&rsquo;ai pas respecté ma méthodologie et je suis parti bille en tête &ldquo;lol je ve trouvé 1 zip&rdquo;. Après avoir vu que ça ne servait à rien d&rsquo;y aller comme un débile, il est temps de se poser et de réfléchir.</p><p>Pour mes tests, j&rsquo;ai installé LibreOffice sur ma machine et lancé le &ldquo;writer&rdquo; (le Word du pauvre):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  ~ ps aux <span class=p>|</span> grep <span class=s1>&#39;office&#39;</span>
</span></span><span class=line><span class=cl>maki     <span class=m>29586</span>  0.0  0.0 <span class=m>176844</span>  <span class=m>5912</span> ?        Sl   15:59   0:00 /usr/lib/libreoffice/program/oosplash --writer
</span></span><span class=line><span class=cl>maki     <span class=m>29601</span>  7.0  1.3 <span class=m>7689752</span> <span class=m>219172</span> ?      Sl   15:59   0:03 /usr/lib/libreoffice/program/soffice.bin --writer --splash-pipe<span class=o>=</span><span class=m>5</span>
</span></span></code></pre></td></tr></table></div></div><p>Visiblement ces processus sont présents aussi dans le dump:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  cat linux_pstree<span class=p>|</span> grep -E <span class=s2>&#34;soffice|oosplash&#34;</span>
</span></span><span class=line><span class=cl>.oosplash            <span class=m>119599</span>          <span class=m>1001</span>           
</span></span><span class=line><span class=cl>soffice.bin          <span class=m>119615</span>          <span class=m>1001</span>           
</span></span></code></pre></td></tr></table></div></div><p>En continuant à piger le fonctionnement de libreOffice, j&rsquo;ai remarqué qu&rsquo;un dossier est apparu dans mon <strong>/tmp</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  /tmp ls -la <span class=p>|</span> grep lu
</span></span><span class=line><span class=cl>drwx------  <span class=m>2</span> maki maki  <span class=m>4096</span> mai    <span class=m>3</span> 15:59 lu29601r4fv4s.tmp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  /tmp ls -la lu29601r4fv4s.tmp 
</span></span><span class=line><span class=cl>total <span class=m>44</span>
</span></span><span class=line><span class=cl>drwx------  <span class=m>2</span> maki maki  <span class=m>4096</span> mai    <span class=m>3</span> 15:59 .
</span></span><span class=line><span class=cl>drwxrwxrwt <span class=m>26</span> root root <span class=m>40960</span> mai    <span class=m>3</span> 15:59 ..
</span></span><span class=line><span class=cl>-rw-------  <span class=m>1</span> maki maki     <span class=m>0</span> mai    <span class=m>3</span> 15:59 lu29601r4fv4t.tmp
</span></span></code></pre></td></tr></table></div></div><p>Un fichier vide, ce dossier est surement utilisé pour la sauvegarde automatique des documents ou ce genre de choses. En théorie, si le fichier est sauvegardé, une copie est présente ici.</p><p>Voyons si ce dossier est présent dans le dump:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_find_file -L &gt; /opt/usr_land/linuxff.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  cat linuxff.txt<span class=p>|</span> grep <span class=s2>&#34;/tmp/lu&#34;</span>
</span></span><span class=line><span class=cl>          <span class=m>923875</span> 0xffff9d72891fe628 /tmp/lu1196159e8v1r.tmp
</span></span><span class=line><span class=cl>          <span class=m>923893</span> 0xffff9d72c2cc3bf8 /tmp/lu1196159e8v1r.tmp/lu1196159e8v23.tmp
</span></span><span class=line><span class=cl>          <span class=m>923884</span> 0xffff9d72c2cc0d90 /tmp/lu1196159e8v1r.tmp/lu1196159e8v22.tmp
</span></span><span class=line><span class=cl>          <span class=m>923876</span> 0xffff9d72891ce628 /tmp/lu1196159e8v1r.tmp/lu1196159e8v1t.tmp
</span></span></code></pre></td></tr></table></div></div><h3 id=mécanisme-de-sauvegarde-de-libreoffice>Mécanisme de sauvegarde de LibreOffice</h3><p>Après avoir créé et sauvegardé un fichier <strong>ODT</strong>, le dossier à bien bougé:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  ~ ls -la /tmp/lu29601r4fv4s.tmp 
</span></span><span class=line><span class=cl>total <span class=m>56</span>
</span></span><span class=line><span class=cl>drwx------  <span class=m>2</span> maki maki  <span class=m>4096</span> mai    <span class=m>3</span> 16:06 .
</span></span><span class=line><span class=cl>drwxrwxrwt <span class=m>27</span> root root <span class=m>40960</span> mai    <span class=m>3</span> 16:06 ..
</span></span><span class=line><span class=cl>-rw-------  <span class=m>1</span> maki maki     <span class=m>0</span> mai    <span class=m>3</span> 16:06 lu29601r4fv4u.tmp
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> maki maki  <span class=m>8504</span> mai    <span class=m>3</span> 16:06 lu29601r4fv4y.tmp
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/xahfjyr.png data-srcset="https://i.imgur.com/xahfjyr.png, https://i.imgur.com/xahfjyr.png 1.5x, https://i.imgur.com/xahfjyr.png 2x" data-sizes=auto alt=https://i.imgur.com/xahfjyr.png title=https://i.imgur.com/xahfjyr.png></p><p>Il s&rsquo;agit bien de notre fichier <strong>ODT</strong>, c&rsquo;est le même hash:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  ~ file /tmp/lu29601r4fv4s.tmp/lu29601r4fv4y.tmp
</span></span><span class=line><span class=cl>/tmp/lu29601r4fv4s.tmp/lu29601r4fv4y.tmp: OpenDocument Text
</span></span><span class=line><span class=cl>➜  ~ md5sum /tmp/lu29601r4fv4s.tmp/lu29601r4fv4y.tmp ~/Documents/ctf/ecsc2020/cestlarentree/Wu/test_odt.odt 
</span></span><span class=line><span class=cl>aba6138e65c1dc360920d63772e5c9c0  /tmp/lu29601r4fv4s.tmp/lu29601r4fv4y.tmp
</span></span><span class=line><span class=cl>aba6138e65c1dc360920d63772e5c9c0  /home/maki/Documents/ctf/ecsc2020/cestlarentree/Wu/test_odt.odt
</span></span></code></pre></td></tr></table></div></div><p>Bon, par contre, on cherche un <strong>DOCX</strong> et pas un ODT. On va retenter l&rsquo;expérience avec un <strong>DOCX</strong>. D&rsquo;ailleurs, les dossiers temporaires se suppriment lorsque que le processus <strong>soffibe.bin</strong> se termine.</p><p>Après la création et la sauvegarde d&rsquo;un fichier <strong>DOCX</strong>, un phénomène intéressant apparait sur les fichiers temporaires&mldr; Ou plutot n&rsquo;apparait pas:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  ~ ls -la /tmp/lu30353r4wuxv.tmp/
</span></span><span class=line><span class=cl>total <span class=m>44</span>
</span></span><span class=line><span class=cl>drwx------  <span class=m>2</span> maki maki  <span class=m>4096</span> mai    <span class=m>3</span> 16:13 .
</span></span><span class=line><span class=cl>drwxrwxrwt <span class=m>26</span> root root <span class=m>40960</span> mai    <span class=m>3</span> 16:13 ..
</span></span><span class=line><span class=cl>-rw-------  <span class=m>1</span> maki maki     <span class=m>0</span> mai    <span class=m>3</span> 16:12 lu30353r4wuxw.tmp
</span></span><span class=line><span class=cl>-rw-------  <span class=m>1</span> maki maki     <span class=m>0</span> mai    <span class=m>3</span> 16:13 lu30353r4wuxx.tmp
</span></span></code></pre></td></tr></table></div></div><p>Les fichiers temporaires sont vides, c&rsquo;est pour cela qu&rsquo;extraire les fichiers temporaires du dump mémoire ne donnent rien, ce n&rsquo;est pas le profile volatility ou encore volatility lui même qui ne fonctionne pas correctement, c&rsquo;est juste que les fichiers existent, mais ne contiennent rien.</p><h3 id=la-structure-dun-docx>La structure d&rsquo;un Docx</h3><p>Si ces fichiers n&rsquo;existent pas dans les fichiers temporaires, alors la structure du <strong>DOCX</strong> doit exister en mémoire. Mais avant, comment ça fonctionne un DOCX.
On vient de créer le fichier suivant: <code>test_docx.docx</code></p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/dW84uui.png data-srcset="https://i.imgur.com/dW84uui.png, https://i.imgur.com/dW84uui.png 1.5x, https://i.imgur.com/dW84uui.png 2x" data-sizes=auto alt=https://i.imgur.com/dW84uui.png title=https://i.imgur.com/dW84uui.png></p><p>Si on prend les premiers octets:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  Wu file test_docx.docx 
</span></span><span class=line><span class=cl>test_docx.docx: Microsoft Word 2007+
</span></span><span class=line><span class=cl>➜  Wu hexdump -C test_docx.docx<span class=p>|</span> head -n <span class=m>5</span>
</span></span><span class=line><span class=cl><span class=m>00000000</span>  <span class=m>50</span> 4b <span class=m>03</span> <span class=m>04</span> <span class=m>14</span> <span class=m>00</span> <span class=m>08</span> <span class=m>08</span>  <span class=m>08</span> <span class=m>00</span> b3 <span class=m>71</span> a3 <span class=m>50</span> <span class=m>00</span> <span class=m>00</span>  <span class=p>|</span>PK.........q.P..<span class=p>|</span>
</span></span><span class=line><span class=cl><span class=m>00000010</span>  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=m>00</span> <span class=m>00</span> 0b <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 5f <span class=m>72</span>  <span class=p>|</span>.............._r<span class=p>|</span>
</span></span><span class=line><span class=cl><span class=m>00000020</span>  <span class=m>65</span> 6c <span class=m>73</span> 2f 2e <span class=m>72</span> <span class=m>65</span> 6c  <span class=m>73</span> ad <span class=m>92</span> 4d 4b <span class=m>03</span> <span class=m>41</span> 0c  <span class=p>|</span>els/.rels..MK.A.<span class=p>|</span>
</span></span><span class=line><span class=cl><span class=m>00000030</span>  <span class=m>86</span> ef fd <span class=m>15</span> <span class=m>43</span> ee dd 6c  2b <span class=m>88</span> c8 ce f6 <span class=m>22</span> <span class=m>42</span> 6f  <span class=p>|</span>....C..l+....<span class=s2>&#34;Bo|
</span></span></span><span class=line><span class=cl><span class=s2>00000040  22 f5 07 84 99 ec ee d0  ce 07 33 69 ad ff de 41  |&#34;</span>.........3i...À<span class=p>|</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/brp7R3a.png data-srcset="https://i.imgur.com/brp7R3a.png, https://i.imgur.com/brp7R3a.png 1.5x, https://i.imgur.com/brp7R3a.png 2x" data-sizes=auto alt=https://i.imgur.com/brp7R3a.png title=https://i.imgur.com/brp7R3a.png></p><blockquote><p><a href=https://en.wikipedia.org/wiki/List_of_file_signatures target=_blank rel="noopener noreffer">https://en.wikipedia.org/wiki/List_of_file_signatures</a></p></blockquote><p>En théorie, il est possible de décompresser un fichier <strong>DOCX</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  unzip test_docx.docx 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  tree .
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>├── <span class=o>[</span>Content_Types<span class=o>]</span>.xml
</span></span><span class=line><span class=cl>├── docProps
</span></span><span class=line><span class=cl>│   ├── app.xml
</span></span><span class=line><span class=cl>│   └── core.xml
</span></span><span class=line><span class=cl>├── _rels
</span></span><span class=line><span class=cl>├── test_docx.docx
</span></span><span class=line><span class=cl>└── word
</span></span><span class=line><span class=cl>    ├── document.xml
</span></span><span class=line><span class=cl>    ├── fontTable.xml
</span></span><span class=line><span class=cl>    ├── _rels
</span></span><span class=line><span class=cl>    │   └── document.xml.rels
</span></span><span class=line><span class=cl>    ├── settings.xml
</span></span><span class=line><span class=cl>    └── styles.xml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>4</span> directories, <span class=m>9</span> files
</span></span></code></pre></td></tr></table></div></div><p>Il y a donc tout un tas de fichiers <strong>XML</strong>. Avec notre DOCX, on sait que le contenu est &ldquo;TEST D’UN FICHIER DOCX&rdquo;. Voyons où il apparait:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/gsgbF1O.png data-srcset="https://i.imgur.com/gsgbF1O.png, https://i.imgur.com/gsgbF1O.png 1.5x, https://i.imgur.com/gsgbF1O.png 2x" data-sizes=auto alt=https://i.imgur.com/gsgbF1O.png title=https://i.imgur.com/gsgbF1O.png></p><p>Good, maintenant on sait qu&rsquo;on cherche le fichier &ldquo;document.xml&rdquo; probablement ouvert en mémoire de <strong>soffice.bin</strong>. Pour s&rsquo;en assurer et éviter de faire un grep comme un débile sur tout le dump, on peut faire une yararule grâce à volatility, en cherchant à partir de <code>&lt;w:document</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_yarascan -Y <span class=s2>&#34;&lt;w:document&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Task: soffice.bin pid <span class=m>119615</span> rule r1 addr 0x5636239689e0
</span></span><span class=line><span class=cl>0x5636239689e0  3c <span class=m>77</span> 3a <span class=m>64</span> 6f <span class=m>63</span> <span class=m>75</span> 6d <span class=m>65</span> 6e <span class=m>74</span> <span class=m>20</span> <span class=m>78</span> 6d 6c 6e   &lt;w:document.xmln
</span></span><span class=line><span class=cl>0x5636239689f0  <span class=m>73</span> 3a 6f 3d <span class=m>22</span> <span class=m>75</span> <span class=m>72</span> 6e 3a <span class=m>73</span> <span class=m>63</span> <span class=m>68</span> <span class=m>65</span> 6d <span class=m>61</span> <span class=m>73</span>   s:o<span class=o>=</span><span class=s2>&#34;urn:schemas
</span></span></span><span class=line><span class=cl><span class=s2>0x563623968a00  2d 6d 69 63 72 6f 73 6f 66 74 2d 63 6f 6d 3a 6f   -microsoft-com:o
</span></span></span><span class=line><span class=cl><span class=s2>0x563623968a10  66 66 69 63 65 3a 6f 66 66 69 63 65 22 20 78 6d   ffice:office&#34;</span>.xm
</span></span><span class=line><span class=cl>0x563623968a20  6c 6e <span class=m>73</span> 3a <span class=m>72</span> 3d <span class=m>22</span> <span class=m>68</span> <span class=m>74</span> <span class=m>74</span> <span class=m>70</span> 3a 2f 2f <span class=m>73</span> <span class=m>63</span>   lns:r<span class=o>=</span><span class=s2>&#34;http://sc
</span></span></span><span class=line><span class=cl><span class=s2>0x563623968a30  68 65 6d 61 73 2e 6f 70 65 6e 78 6d 6c 66 6f 72   hemas.openxmlfor
</span></span></span><span class=line><span class=cl><span class=s2>0x563623968a40  6d 61 74 73 2e 6f 72 67 2f 6f 66 66 69 63 65 44   mats.org/officeD
</span></span></span><span class=line><span class=cl><span class=s2>0x563623968a50  6f 63 75 6d 65 6e 74 2f 32 30 30 36 2f 72 65 6c   ocument/2006/rel
</span></span></span><span class=line><span class=cl><span class=s2>0x563623968a60  61 74 69 6f 6e 73 68 69 70 73 22 20 78 6d 6c 6e   ationships&#34;</span>.xmln
</span></span><span class=line><span class=cl>0x563623968a70  <span class=m>73</span> 3a <span class=m>76</span> 3d <span class=m>22</span> <span class=m>75</span> <span class=m>72</span> 6e 3a <span class=m>73</span> <span class=m>63</span> <span class=m>68</span> <span class=m>65</span> 6d <span class=m>61</span> <span class=m>73</span>   s:v<span class=o>=</span><span class=s2>&#34;urn:schemas
</span></span></span><span class=line><span class=cl><span class=s2>0x563623968a80  2d 6d 69 63 72 6f 73 6f 66 74 2d 63 6f 6d 3a 76   -microsoft-com:v
</span></span></span><span class=line><span class=cl><span class=s2>0x563623968a90  6d 6c 22 20 78 6d 6c 6e 73 3a 77 3d 22 68 74 74   ml&#34;</span>.xmlns:w<span class=o>=</span><span class=s2>&#34;htt
</span></span></span><span class=line><span class=cl><span class=s2>0x563623968aa0  70 3a 2f 2f 73 63 68 65 6d 61 73 2e 6f 70 65 6e   p://schemas.open
</span></span></span><span class=line><span class=cl><span class=s2>0x563623968ab0  78 6d 6c 66 6f 72 6d 61 74 73 2e 6f 72 67 2f 77   xmlformats.org/w
</span></span></span><span class=line><span class=cl><span class=s2>0x563623968ac0  6f 72 64 70 72 6f 63 65 73 73 69 6e 67 6d 6c 2f   ordprocessingml/
</span></span></span><span class=line><span class=cl><span class=s2>0x563623968ad0  32 30 30 36 2f 6d 61 69 6e 22 20 78 6d 6c 6e 73   2006/main&#34;</span>.xmlns
</span></span></code></pre></td></tr></table></div></div><p>Bon et bien on dirait que le <strong>document.xml</strong> a été retrouvé à l&rsquo;adresse <strong>0x5636239689e0</strong>.</p><h3 id=extraction-de-la-zone-mémoire-de-sofficebin>Extraction de la zone mémoire de soffice.bin</h3><p>Il ne reste plus qu&rsquo;à extraire cette portion de la mémoire. D&rsquo;abord localiser notre adresse trouvée précédemment:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_proc_maps -p <span class=m>119615</span>
</span></span><span class=line><span class=cl>Offset             Pid      Name                 Start              End                Flags               Pgoff Major  Minor  Inode      File Path
</span></span><span class=line><span class=cl>------------------ -------- -------------------- ------------------ ------------------ ------ ------------------ ------ ------ ---------- ---------
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>0xffff9d72848edd00   <span class=m>119615</span> soffice.bin          0x000056361c0cb000 0x0000563623f25000 rw-                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> <span class=o>[</span>heap<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p>On dirait bien que notre adresse se trouve dans la heap du processus <strong>soffice.bin</strong>. Il ne reste qu&rsquo;à l&rsquo;extraire:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_dump_map -p <span class=m>119615</span> -s 0x000056361c0cb000 -D /opt/usr_land/wu/
</span></span><span class=line><span class=cl>Task       VM Start           VM End                         Length Path
</span></span><span class=line><span class=cl>---------- ------------------ ------------------ ------------------ ----
</span></span><span class=line><span class=cl>    <span class=m>119615</span> 0x000056361c0cb000 0x0000563623f25000          0x7e5a000 /opt/usr_land/Wu/task.119615.0x56361c0cb000.vma
</span></span></code></pre></td></tr></table></div></div><h3 id=chercher-la-structure-du-xml>Chercher la structure du XML</h3><p>Maintenant, l&rsquo;outil indispensable:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/CNqJpb3.png data-srcset="https://i.imgur.com/CNqJpb3.png, https://i.imgur.com/CNqJpb3.png 1.5x, https://i.imgur.com/CNqJpb3.png 2x" data-sizes=auto alt=https://i.imgur.com/CNqJpb3.png title=https://i.imgur.com/CNqJpb3.png></p><h3 id=flag-4>Flag</h3><blockquote><p>FCSC{PQHJRTSFYH-3467024-LSHRFLDFGA}</p></blockquote><hr><h2 id=académie---dans-les-nuages>Académie - Dans les nuages</h2><blockquote><p>Le poste en cours d&rsquo;analyse est connecté à un serveur web à l&rsquo;adresse 10.42.42.132. Le serveur web est protégé par une authentification.</p><p>Retrouvez le nom d&rsquo;utilisateur et le mot de passe de cette connexion.
Format du flag :</p><p>FCSC{utilisateur:mot_de_passe}. Ce flag est sensible à la casse.</p></blockquote><h3 id=tldr-5>TL;DR</h3><p>Pour ce challenge, il faut recréer l&rsquo;infrastructure de l&rsquo;authentification afin de voir où se trouvent en mémoire les identifiants. Au final, on se retrouve dans une section mémoire de chromium avec les identifiants à la suite encodés en utf16.</p><h3 id=état-des-lieux-3>État des lieux</h3><p>Alors pour ce dernier challenge d&rsquo;une série très intéressante, c&rsquo;est vraiment le boss final. Si on devait faire l&rsquo;analogie de ce challenge avec autre chose, on pourrait dire que c&rsquo;est comme chercher une aiguille, dans un tas d&rsquo;autres aiguilles et le tout dans un gros tas de foin.</p><p>Donc là, on va essayer de ne pas partir comme un débile, parce que déjà que dans les challenges de forensic c&rsquo;est facile de se perdre, mais alors ici, c&rsquo;est presque sûr.</p><p>Ce qu&rsquo;on sait:</p><ul><li>Adresse IP du serveur web : 10.42.42.132;</li><li>Authentification par login / mot de passe (basic auth ? form html ?).</li></ul><p>Ce qu&rsquo;on cherche:</p><ul><li>Des identifiants (user/password).</li></ul><p>La première chose qui peut être utile est de faire un yarascan sur l&rsquo;adresse IP pour essayer d&rsquo;avoir des pistes de recherches:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_yarascan -Y <span class=s2>&#34;10.42.42.132&#34;</span> <span class=p>|</span> tee /opt/usr_land/yarascan_10.42.42.132.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  yarascan_10.42.42.132.txt <span class=p>|</span> grep -B <span class=m>2</span> Task
</span></span><span class=line><span class=cl><span class=o>[</span>.. L<span class=s1>&#39;output est suuuuper verbeuse, donc j&#39;</span>vais trier pour le WU :<span class=o>)</span> ..<span class=o>]</span>
</span></span><span class=line><span class=cl>Task: chromium pid <span class=m>119148</span> rule r1 addr 0x55f4346630eb
</span></span><span class=line><span class=cl>0x55f4346630eb  <span class=m>31</span> <span class=m>30</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>31</span> <span class=m>33</span> <span class=m>32</span> 2f <span class=m>70</span> <span class=m>61</span> 6e   10.42.42.132/pan
</span></span><span class=line><span class=cl>0x55f4346630fb  <span class=m>65</span> 6c 2f <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>04</span> <span class=m>00</span> <span class=m>00</span>   el/.............
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>Task: chromium pid <span class=m>119187</span> rule r1 addr 0x7fb1cc18dfa7
</span></span><span class=line><span class=cl>0x7fb1cc18dfa7  <span class=m>31</span> <span class=m>30</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>31</span> <span class=m>33</span> <span class=m>32</span> 2f <span class=m>66</span> <span class=m>61</span> <span class=m>76</span>   10.42.42.132/fav
</span></span><span class=line><span class=cl>0x7fb1cc18dfb7  <span class=m>69</span> <span class=m>63</span> 6f 6e 2e <span class=m>69</span> <span class=m>63</span> 6f <span class=m>00</span> <span class=m>10</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>   icon.ico........
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>Task: chromium pid <span class=m>119218</span> rule r1 addr 0x7efedc023373
</span></span><span class=line><span class=cl>0x7efedc023373  <span class=m>31</span> <span class=m>30</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>31</span> <span class=m>33</span> <span class=m>32</span> 2f <span class=m>70</span> <span class=m>61</span> 6e   10.42.42.132/pan
</span></span><span class=line><span class=cl>0x7efedc023383  <span class=m>65</span> 6c 2f <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>03</span> <span class=m>00</span> <span class=m>00</span>   el/.............
</span></span><span class=line><span class=cl>--
</span></span><span class=line><span class=cl>Task: chromium pid <span class=m>119233</span> rule r1 addr 0x55f4febd60eb
</span></span><span class=line><span class=cl>0x55f4febd60eb  <span class=m>31</span> <span class=m>30</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>31</span> <span class=m>33</span> <span class=m>32</span> 2f <span class=m>70</span> <span class=m>61</span> 6e   10.42.42.132/pan
</span></span><span class=line><span class=cl>0x55f4febd60fb  <span class=m>65</span> 6c 2f <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>04</span> <span class=m>00</span> <span class=m>00</span>   el/.............
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>Task: chromium pid <span class=m>119274</span> rule r1 addr 0x55f504bf68b9
</span></span><span class=line><span class=cl>0x55f504bf68b9  <span class=m>31</span> <span class=m>30</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>31</span> <span class=m>33</span> <span class=m>32</span> 3a <span class=m>38</span> <span class=m>30</span> 2c   10.42.42.132:80,
</span></span><span class=line><span class=cl>0x55f504bf68c9  2a <span class=m>22</span> 3a 7b <span class=m>22</span> 6c <span class=m>61</span> <span class=m>73</span> <span class=m>74</span> 5f 6d 6f <span class=m>64</span> <span class=m>69</span> <span class=m>66</span> <span class=m>69</span>   *<span class=s2>&#34;:{&#34;</span>last_modifi
</span></span><span class=line><span class=cl>--
</span></span><span class=line><span class=cl>Task: chromium pid <span class=m>119302</span> rule r1 addr 0x55f4febd60eb
</span></span><span class=line><span class=cl>0x55f4febd60eb  <span class=m>31</span> <span class=m>30</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>31</span> <span class=m>33</span> <span class=m>32</span> 2f <span class=m>70</span> <span class=m>61</span> 6e   10.42.42.132/pan
</span></span><span class=line><span class=cl>0x55f4febd60fb  <span class=m>65</span> 6c 2f <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>04</span> <span class=m>00</span> <span class=m>00</span>   el/.............
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>Task: chromium pid <span class=m>119364</span> rule r1 addr 0x16a55ae239d3
</span></span><span class=line><span class=cl>0x16a55ae239d3  <span class=m>31</span> <span class=m>30</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>31</span> <span class=m>33</span> <span class=m>32</span> <span class=m>65</span> <span class=m>02</span> <span class=m>00</span> <span class=m>00</span>   10.42.42.132e...
</span></span><span class=line><span class=cl>0x16a55ae239e3  <span class=m>00</span> 0e <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 4a <span class=m>41</span> <span class=m>63</span> <span class=m>63</span> <span class=m>65</span> <span class=m>73</span> <span class=m>73</span> <span class=m>20</span>   ........JAccess.
</span></span><span class=line><span class=cl>--
</span></span><span class=line><span class=cl>Task: soffice.bin pid <span class=m>119615</span> rule r1 addr 0x7fee90d25b1b
</span></span><span class=line><span class=cl>0x7fee90d25b1b  <span class=m>31</span> <span class=m>30</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>31</span> <span class=m>33</span> <span class=m>32</span> <span class=m>44</span> <span class=m>43</span> <span class=m>46</span> <span class=m>37</span>   10.42.42.132DCF7
</span></span><span class=line><span class=cl>0x7fee90d25b2b  <span class=m>41</span> <span class=m>35</span> <span class=m>38</span> <span class=m>39</span> <span class=m>35</span> <span class=m>42</span> <span class=m>46</span> <span class=m>37</span> <span class=m>41</span> <span class=m>37</span> <span class=m>45</span> <span class=m>43</span> <span class=m>31</span> <span class=m>37</span> <span class=m>41</span> <span class=m>39</span>   A5895BF7A7EC17A9
</span></span><span class=line><span class=cl>--
</span></span><span class=line><span class=cl>Task: chromium pid <span class=m>119757</span> rule r1 addr 0x55f4febd60eb
</span></span><span class=line><span class=cl>0x55f4febd60eb  <span class=m>31</span> <span class=m>30</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>34</span> <span class=m>32</span> 2e <span class=m>31</span> <span class=m>33</span> <span class=m>32</span> 2f <span class=m>70</span> <span class=m>61</span> 6e   10.42.42.132/pan
</span></span><span class=line><span class=cl>0x55f4febd60fb  <span class=m>65</span> 6c 2f <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>04</span> <span class=m>00</span> <span class=m>00</span>   el/.............
</span></span></code></pre></td></tr></table></div></div><p>Bon, cet énorme output nous apprend plusieurs choses:</p><ul><li>Probablement que Chromium a été utilisé pour la connexion ;</li><li>Il existe un dossier <code>/panel/</code>.</li></ul><p>Il existe d&rsquo;autres outils que <strong>volatility</strong> pour analyser la mémoire, par exemple <strong>bulk_extractor</strong> permet notamment de créer un pcap avec les traces laissées dans le dump:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  bulk_extractor -o bulk dmp.mem
</span></span></code></pre></td></tr></table></div></div><p>Le pcap généré nous donne quelques informations supplémentaires:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/jPpypD8.png data-srcset="https://i.imgur.com/jPpypD8.png, https://i.imgur.com/jPpypD8.png 1.5x, https://i.imgur.com/jPpypD8.png 2x" data-sizes=auto alt=https://i.imgur.com/jPpypD8.png title=https://i.imgur.com/jPpypD8.png></p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/P0VtaMy.png data-srcset="https://i.imgur.com/P0VtaMy.png, https://i.imgur.com/P0VtaMy.png 1.5x, https://i.imgur.com/P0VtaMy.png 2x" data-sizes=auto alt=https://i.imgur.com/P0VtaMy.png title=https://i.imgur.com/P0VtaMy.png></p><p>On répond donc à une question du début sur le type d&rsquo;authentification, c&rsquo;est une <strong>Basic authentication</strong>, le realm est <strong>Panel \o/</strong> et le serveur web utilisé est un <strong>nginx 1.14.2</strong>. Ce qui est un marqueur supplémentaire pour notre recherche.</p><p>Avant d&rsquo;aller plus loin, une connexion via Basic authentication, se fait avec une pop qui demande les identifiants. Ces identifiants sont placés dans un header HTTP <strong>Authorization: Basic base64(username:password)</strong>.</p><p>Après quelques recherches non concluantes autour de ça, il est temps de revoir la méthode de travail. Le but va être de recréer une connexion entre un client Chromium et un serveur web.</p><h3 id=proof-of-concept>Proof of concept</h3><h4 id=mise-en-place-de-linfrastructure>Mise en place de l&rsquo;infrastructure</h4><p>Pour la partie <strong>client</strong>, on a déjà la VM de test: celle qui nous a permis de faire le profil volatility dans les challenges précédents. Il ne reste qu&rsquo;à installer une interface graphique (comme xfce4) et <strong>chromium</strong>.</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/OMEUTfe.png data-srcset="https://i.imgur.com/OMEUTfe.png, https://i.imgur.com/OMEUTfe.png 1.5x, https://i.imgur.com/OMEUTfe.png 2x" data-sizes=auto alt=https://i.imgur.com/OMEUTfe.png title=https://i.imgur.com/OMEUTfe.png></p><p>Pour le serveur nginx, un bon vieux Docker Debian fera l&rsquo;affaire en suivant un bon p&rsquo;tit tuto des familles:</p><blockquote><p><a href=https://ahmet.im/blog/docker-http-basic-auth/ target=_blank rel="noopener noreffer">https://ahmet.im/blog/docker-http-basic-auth/</a></p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  ~ docker run --name basic_authent -p4242:4242 -ti debian:latest /bin/bash
</span></span><span class=line><span class=cl>➜  <span class=o>(</span>docker<span class=o>)</span> apt-get install nginx apache2-utils
</span></span><span class=line><span class=cl>➜  <span class=o>(</span>docker<span class=o>)</span> htpasswd -c /etc/nginx/.htpasswd maki
</span></span><span class=line><span class=cl>Password: JeSuisUnGrosZgueg
</span></span><span class=line><span class=cl>➜  <span class=o>(</span>docker<span class=o>)</span> sed -i <span class=s1>&#39;s/user .*;/user root;/&#39;</span> /etc/nginx/nginx.conf
</span></span><span class=line><span class=cl>➜  <span class=o>(</span>docker<span class=o>)</span> tee /etc/nginx/sites-enabled/docker <span class=s>&lt;&lt;EOF 
</span></span></span><span class=line><span class=cl><span class=s>upstream docker {
</span></span></span><span class=line><span class=cl><span class=s>  server unix:/var/run/docker.sock;
</span></span></span><span class=line><span class=cl><span class=s>}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>server {
</span></span></span><span class=line><span class=cl><span class=s>  listen 4242 default_server;
</span></span></span><span class=line><span class=cl><span class=s>  location / {
</span></span></span><span class=line><span class=cl><span class=s>    proxy_pass http://docker;
</span></span></span><span class=line><span class=cl><span class=s>    auth_basic_user_file /etc/nginx/.htpasswd;
</span></span></span><span class=line><span class=cl><span class=s>    auth_basic &#34;SecretPanelMofo&#34;;
</span></span></span><span class=line><span class=cl><span class=s>  }
</span></span></span><span class=line><span class=cl><span class=s>}
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>➜  <span class=o>(</span>docker<span class=o>)</span> service nginx restart
</span></span></code></pre></td></tr></table></div></div><p>L&rsquo;infrastructure a l&rsquo;air d&rsquo;être prête, on redémarre la machine cliente pour vider la mémoire et on initialise une connexion. Le prompt apparait et on entre 1 fois les mauvais identifiants et 1 fois les bons, pour avoir un statut <strong>401</strong> comme dans bulk_extractor et un <strong>200</strong>, parce que c&rsquo;est quand même les bons identifiants qu&rsquo;on cherche à la base.</p><p>Les mauvais identifiants:</p><blockquote><p>USERPASBON_MARQUEUR : USERPASBON_MARQUEURPASS</p></blockquote><p>Les bons identifiants:</p><blockquote><p>maki : JeSuisUnGrosZgueg</p></blockquote><p>Maintenant on met la machine en pause et on récupère la mémoire. Utilisant <strong>VMWare</strong>, il est possible de récupérer la mémoire avec le fichier <strong>vmem</strong>.</p><h4 id=analyse-du-poc>Analyse du PoC</h4><p>Comme on a utilisé la même machine virtuelle que pour la création du profil, on s&rsquo;épargne une étape fastidieuse:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/localtest/test<span class=se>\ </span>ecsc<span class=se>\ </span>deb10-f35aa608.vmem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_banner
</span></span><span class=line><span class=cl>Linux version 5.4.0-4-amd64 <span class=o>(</span>debian-kernel@lists.debian.org<span class=o>)</span> <span class=o>(</span>gcc version 9.2.1 <span class=m>20200203</span> <span class=o>(</span>Debian 9.2.1-28<span class=o>))</span> <span class=c1>#1 SMP Debian 5.4.19-1 (2020-02-13)</span>
</span></span></code></pre></td></tr></table></div></div><p>Il est temps de partir à la recherche de nos marqueurs, pas classe, mais efficace. Avant d&rsquo;attendre 5 minutes qu&rsquo;un Yarascan se termine, on va vérifier que les identifiants apparaissent bien en clair dans la mémoire:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  localtest strings test<span class=se>\ </span>ecsc<span class=se>\ </span>deb10-f35aa608.vmem<span class=p>|</span> grep -E <span class=s1>&#39;^maki$|JeSuisUnGrosZgueg&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq
</span></span><span class=line><span class=cl>maki
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  strings -e l test<span class=se>\ </span>ecsc<span class=se>\ </span>deb10-f35aa608.vmem<span class=p>|</span> grep -E <span class=s1>&#39;maki|JeSuisUnGrosZgueg&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq
</span></span><span class=line><span class=cl>mikmaki
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>maki
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>JeSuisUnGrosZgueg
</span></span></code></pre></td></tr></table></div></div><p>Par contre, les identifiants en mémoire sont encodés sur 16 bytes. Il faut donc adapter la rule en conséquence:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/localtest/test<span class=se>\ </span>ecsc<span class=se>\ </span>deb10-f35aa608.vmem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_yarascan -Y <span class=s2>&#34;{4a ?? 65 ?? 53 ?? 75 ?? 69 ?? 73 ?? 55 ?? 6e ?? 47}&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Task: chromium pid <span class=m>861</span> rule r1 addr 0x7f30980e8ea0
</span></span><span class=line><span class=cl>0x7f30980e8ea0  4a <span class=m>00</span> <span class=m>65</span> <span class=m>00</span> <span class=m>53</span> <span class=m>00</span> <span class=m>75</span> <span class=m>00</span> <span class=m>69</span> <span class=m>00</span> <span class=m>73</span> <span class=m>00</span> <span class=m>55</span> <span class=m>00</span> 6e <span class=m>00</span>   J.e.S.u.i.s.U.n.
</span></span><span class=line><span class=cl>0x7f30980e8eb0  <span class=m>47</span> <span class=m>00</span> <span class=m>72</span> <span class=m>00</span> 6f <span class=m>00</span> <span class=m>73</span> <span class=m>00</span> 5a <span class=m>00</span> <span class=m>67</span> <span class=m>00</span> <span class=m>75</span> <span class=m>00</span> <span class=m>65</span> <span class=m>00</span>   G.r.o.s.Z.g.u.e.
</span></span><span class=line><span class=cl>0x7f30980e8ec0  <span class=m>67</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>95</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>   g...............
</span></span><span class=line><span class=cl>0x7f30980e8ed0  <span class=m>10</span> af <span class=m>00</span> 8c <span class=m>30</span> 7f <span class=m>00</span> <span class=m>00</span> d0 <span class=m>08</span> <span class=m>00</span> <span class=m>98</span> <span class=m>30</span> 7f <span class=m>00</span> <span class=m>00</span>   ....0.......0...
</span></span><span class=line><span class=cl>0x7f30980e8ee0  a0 dd <span class=m>06</span> <span class=m>98</span> <span class=m>30</span> 7f <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>   ....0...........
</span></span><span class=line><span class=cl>0x7f30980e8ef0  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>   ................
</span></span><span class=line><span class=cl>0x7f30980e8f00  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>01</span> <span class=m>09</span> <span class=m>98</span> <span class=m>30</span> 7f <span class=m>00</span> <span class=m>00</span>   ............0...
</span></span><span class=line><span class=cl>0x7f30980e8f10  <span class=m>40</span> 3a <span class=m>02</span> <span class=m>98</span> <span class=m>30</span> 7f <span class=m>00</span> <span class=m>00</span> <span class=m>48</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>   @:..0...H.......
</span></span><span class=line><span class=cl>0x7f30980e8f20  <span class=m>88</span> 3a <span class=m>02</span> <span class=m>98</span> <span class=m>30</span> 7f <span class=m>00</span> <span class=m>00</span> <span class=m>50</span> <span class=m>02</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>   .:..0...P.......
</span></span><span class=line><span class=cl>0x7f30980e8f30  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>   ................
</span></span><span class=line><span class=cl>0x7f30980e8f40  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> e8 <span class=m>49</span> 8a 9d ad c4 e5 bb   .........I......
</span></span><span class=line><span class=cl>0x7f30980e8f50  be 3d 6c <span class=m>31</span> df <span class=m>92</span> <span class=m>20</span> <span class=m>98</span> <span class=m>25</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>   .<span class=o>=</span>l1....%.......
</span></span><span class=line><span class=cl>0x7f30980e8f60  <span class=m>01</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 7f <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>   ................
</span></span><span class=line><span class=cl>0x7f30980e8f70  <span class=m>69</span> <span class=m>64</span> <span class=m>61</span> <span class=m>74</span> 6f <span class=m>72</span> <span class=m>00</span> <span class=m>00</span> a5 <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>   idator..........
</span></span><span class=line><span class=cl>0x7f30980e8f80  <span class=m>02</span> <span class=m>00</span> <span class=m>01</span> bb d8 3a ce e3 <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>   .....:..........
</span></span><span class=line><span class=cl>0x7f30980e8f90  <span class=m>77</span> <span class=m>77</span> <span class=m>77</span> 2e <span class=m>67</span> <span class=m>73</span> <span class=m>74</span> <span class=m>61</span> <span class=m>74</span> <span class=m>69</span> <span class=m>63</span> 2e <span class=m>63</span> 6f 6d <span class=m>00</span>   www.gstatic.com.
</span></span></code></pre></td></tr></table></div></div><p>Sans trop de surprises, le mot de passe est présent dans la mémoire de chromium. Mais où exactement:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/localtest/test<span class=se>\ </span>ecsc<span class=se>\ </span>deb10-f35aa608.vmem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_proc_maps -p <span class=m>861</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Offset             Pid      Name                 Start              End                Flags               Pgoff Major  Minor  Inode      File Path
</span></span><span class=line><span class=cl>------------------ -------- -------------------- ------------------ ------------------ ------ ------------------ ------ ------ ---------- ---------
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80      <span class=m>861</span> chromium             0x000055943fbb1000 0x000055943fc9f000 rw-                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> <span class=o>[</span>heap<span class=o>]</span>
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80      <span class=m>861</span> chromium             0x00007f3084000000 0x00007f308416c000 rw-                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> 
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80      <span class=m>861</span> chromium             0x00007f308416c000 0x00007f3088000000 ---                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> 
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80      <span class=m>861</span> chromium             0x00007f3088000000 0x00007f3088021000 rw-                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> 
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80      <span class=m>861</span> chromium             0x00007f3088021000 0x00007f308c000000 ---                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> 
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80      <span class=m>861</span> chromium             0x00007f308c000000 0x00007f308c062000 rw-                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> 
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80      <span class=m>861</span> chromium             0x00007f308c062000 0x00007f3090000000 ---                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> 
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80      <span class=m>861</span> chromium             0x00007f3090000000 0x00007f3090021000 rw-                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> 
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80      <span class=m>861</span> chromium             0x00007f3090021000 0x00007f3094000000 ---                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> 
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80      <span class=m>861</span> chromium             0x00007f3094000000 0x00007f30941ba000 rw-                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> 
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80      <span class=m>861</span> chromium             0x00007f30941ba000 0x00007f3098000000 ---                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> 
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80      <span class=m>861</span> chromium             0x00007f3098000000 0x00007f3098118000 rw-                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> 
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80      <span class=m>861</span> chromium             0x00007f3098118000 0x00007f309c000000 ---                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> 
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80      <span class=m>861</span> chromium             0x00007f309c000000 0x00007f309c021000 rw-                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> 
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80      <span class=m>861</span> chromium             0x00007f309c021000 0x00007f30a0000000 ---                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> 
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80      <span class=m>861</span> chromium             0x00007f30a16d5000 0x00007f30a16de000 r--                   0x0      <span class=m>8</span>      <span class=m>1</span>    <span class=m>1063603</span> /
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p>Bon, on se retrouve dans une zone mémoire perdue au milieu de tout ce bazar, entre la heap et la mémoire allouée par des fichiers. Il suffit de l&rsquo;extraire pour trouver ce qu&rsquo;il y a dedans:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/localtest/test<span class=se>\ </span>ecsc<span class=se>\ </span>deb10-f35aa608.vmem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_dump_map -s 0x00007f3098000000 -p <span class=m>861</span> -D /opt/usr_land/wu/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Task       VM Start           VM End                         Length Path
</span></span><span class=line><span class=cl>---------- ------------------ ------------------ ------------------ ----
</span></span><span class=line><span class=cl>       <span class=m>861</span> 0x00007f3098000000 0x00007f3098118000           0x118000 /opt/usr_land/Wu/task.861.0x7f3098000000.vma
</span></span></code></pre></td></tr></table></div></div><p>Et dedans on retrouve bien nos identifiants:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  strings -e l task.861.0x7f3098000000.vma
</span></span><span class=line><span class=cl>maki
</span></span><span class=line><span class=cl>maki
</span></span><span class=line><span class=cl>f us
</span></span><span class=line><span class=cl>kN6U
</span></span><span class=line><span class=cl>_MAR
</span></span><span class=line><span class=cl>JeSuisUnGrosZgueg
</span></span><span class=line><span class=cl>4N6U
</span></span><span class=line><span class=cl>	dgknorst<span class=o>}</span>
</span></span><span class=line><span class=cl>46<span class=o>]</span>_cfilv<span class=o>{</span>
</span></span><span class=line><span class=cl><span class=err>&#39;</span><span class=o>)</span>.01238<span class=o>[</span>hjmuy
</span></span></code></pre></td></tr></table></div></div><p>A première vue, il n&rsquo;y a pas de marqueurs efficaces pour localiser les identifiants dans le dump du challenge. Par contre, il peut être intéressant de regarder tous ça d&rsquo;un point de vu hexa:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>000e8e80  e0 c1 0d <span class=m>98</span> <span class=m>30</span> 7f <span class=m>00</span> <span class=m>00</span>  <span class=m>60</span> <span class=m>86</span> 0e <span class=m>98</span> <span class=m>30</span> 7f <span class=m>00</span> <span class=m>00</span>  <span class=p>|</span>....0...<span class=sb>`</span>...0...<span class=p>|</span>
</span></span><span class=line><span class=cl>000e8e90  <span class=m>70</span> 6e 0e <span class=m>98</span> <span class=m>30</span> 7f <span class=m>00</span> <span class=m>00</span>  <span class=m>35</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=p>|</span>pn..0...5.......<span class=p>|</span>
</span></span><span class=line><span class=cl>000e8ea0  4a <span class=m>00</span> <span class=m>65</span> <span class=m>00</span> <span class=m>53</span> <span class=m>00</span> <span class=m>75</span> <span class=m>00</span>  <span class=m>69</span> <span class=m>00</span> <span class=m>73</span> <span class=m>00</span> <span class=m>55</span> <span class=m>00</span> 6e <span class=m>00</span>  <span class=p>|</span>J.e.S.u.i.s.U.n.<span class=p>|</span>
</span></span><span class=line><span class=cl>000e8eb0  <span class=m>47</span> <span class=m>00</span> <span class=m>72</span> <span class=m>00</span> 6f <span class=m>00</span> <span class=m>73</span> <span class=m>00</span>  5a <span class=m>00</span> <span class=m>67</span> <span class=m>00</span> <span class=m>75</span> <span class=m>00</span> <span class=m>65</span> <span class=m>00</span>  <span class=p>|</span>G.r.o.s.Z.g.u.e.<span class=p>|</span>
</span></span><span class=line><span class=cl>000e8ec0  <span class=m>67</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=m>95</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=p>|</span>g...............<span class=p>|</span>
</span></span><span class=line><span class=cl>000e8ed0  <span class=m>10</span> af <span class=m>00</span> 8c <span class=m>30</span> 7f <span class=m>00</span> <span class=m>00</span>  d0 <span class=m>08</span> <span class=m>00</span> <span class=m>98</span> <span class=m>30</span> 7f <span class=m>00</span> <span class=m>00</span>  <span class=p>|</span>....0.......0...<span class=p>|</span>
</span></span><span class=line><span class=cl>000e8ee0  a0 dd <span class=m>06</span> <span class=m>98</span> <span class=m>30</span> 7f <span class=m>00</span> <span class=m>00</span>  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=p>|</span>....0...........<span class=p>|</span>
</span></span><span class=line><span class=cl>000e8ef0  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=p>|</span>................<span class=p>|</span>
</span></span><span class=line><span class=cl>000e8f00  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=m>00</span> <span class=m>01</span> <span class=m>09</span> <span class=m>98</span> <span class=m>30</span> 7f <span class=m>00</span> <span class=m>00</span>  <span class=p>|</span>............0...<span class=p>|</span>
</span></span><span class=line><span class=cl>000e8f10  <span class=m>40</span> 3a <span class=m>02</span> <span class=m>98</span> <span class=m>30</span> 7f <span class=m>00</span> <span class=m>00</span>  <span class=m>48</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=p>|</span>@:..0...H.......<span class=p>|</span>
</span></span></code></pre></td></tr></table></div></div><p>Quelque chose qui pourrait être intéressant est de chercher l&rsquo;adresse de la chaine de caractère: <code>0x7f30980e8ea0</code>. Et là, un alignement de planète:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/YshCwgF.png data-srcset="https://i.imgur.com/YshCwgF.png, https://i.imgur.com/YshCwgF.png 1.5x, https://i.imgur.com/YshCwgF.png 2x" data-sizes=auto alt=https://i.imgur.com/YshCwgF.png title=https://i.imgur.com/YshCwgF.png></p><ul><li>Vert: Adresse de la chaine pour le &ldquo;realm&rdquo;</li><li>Le second pointeur après la chaine du realm (rouge): Adresse pour le nom d&rsquo;utilisateur</li><li>Le troisième pointeur après la chaine du realm (jaune): Adresse pour le mot de passe</li></ul><p>C ce n&rsquo;est pas si étonnant, dans les sources de Chromium il y a ceci:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/P2JFP1e.png data-srcset="https://i.imgur.com/P2JFP1e.png, https://i.imgur.com/P2JFP1e.png 1.5x, https://i.imgur.com/P2JFP1e.png 2x" data-sizes=auto alt=https://i.imgur.com/P2JFP1e.png title=https://i.imgur.com/P2JFP1e.png></p><blockquote><p><a href=https://chromium.googlesource.com/chromium/src/net/+/master/http/http_auth_controller.cc target=_blank rel="noopener noreffer">https://chromium.googlesource.com/chromium/src/net/+/master/http/http_auth_controller.cc</a></p></blockquote><p>On commence à y voir plus clair dans cette histoire, mais faut-il encore trouver dans quel processus chercher:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/localtest/test<span class=se>\ </span>ecsc<span class=se>\ </span>deb10-f35aa608.vmem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_pstree <span class=p>|</span> grep chromium
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.....chromium        <span class=m>821</span>             <span class=m>1000</span>           
</span></span><span class=line><span class=cl>.......chromium      <span class=m>836</span>             <span class=m>1000</span>           
</span></span><span class=line><span class=cl>........chromium     <span class=m>838</span>             <span class=m>1000</span>           
</span></span><span class=line><span class=cl>.........chromium    <span class=m>981</span>             <span class=m>1000</span>           
</span></span><span class=line><span class=cl>.........chromium    <span class=m>993</span>             <span class=m>1000</span>           
</span></span><span class=line><span class=cl>chromium             <span class=m>859</span>             <span class=m>1000</span>           
</span></span><span class=line><span class=cl>.chromium            <span class=m>940</span>             <span class=m>1000</span>           
</span></span><span class=line><span class=cl>chromium             <span class=m>861</span>             <span class=m>1000</span>           
</span></span></code></pre></td></tr></table></div></div><p>Pour savoir correctement d&rsquo;où vient notre processus, même s&rsquo;il n&rsquo;a pas de parent, il a été lancé par quelque chose. Les plugins <code>pslist</code> et <code>psscan</code> vont répondre à ces questions:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/test<span class=se>\ </span>ecsc<span class=se>\ </span>deb10-f35aa608.vmem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_pslist <span class=p>|</span> grep <span class=m>861</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Offset             Name                 Pid             PPid            Uid             Gid    DTB                Start Time
</span></span><span class=line><span class=cl>------------------ -------------------- --------------- --------------- --------------- ------ ------------------ ----------
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80 chromium             <span class=m>861</span>             <span class=m>852</span>             <span class=m>1000</span>            <span class=m>1000</span>   0x000000007692e000 2020-04-28 19:19:35 UTC+0000
</span></span></code></pre></td></tr></table></div></div><p>Le processus <strong>852</strong> n&rsquo;est autre que <code>ThreadPoolSingl</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/test<span class=se>\ </span>ecsc<span class=se>\ </span>deb10-f35aa608.vmem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_psscan <span class=p>|</span> grep <span class=m>852</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Offset             Name                 Pid             PPid            Uid             Gid    DTB                Start Time
</span></span><span class=line><span class=cl>------------------ -------------------- --------------- --------------- --------------- ------ ------------------ ----------
</span></span><span class=line><span class=cl>0x00000000768e8000 ThreadPoolSingl      <span class=m>852</span>             -               -               -      ------------------ -
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/test<span class=se>\ </span>ecsc<span class=se>\ </span>deb10-f35aa608.vmem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_pslist <span class=p>|</span> grep <span class=m>852</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Offset             Name                 Pid             PPid            Uid             Gid    DTB                Start Time
</span></span><span class=line><span class=cl>------------------ -------------------- --------------- --------------- --------------- ------ ------------------ ----------
</span></span><span class=line><span class=cl>0xffff99baf6930000 chromium             <span class=m>859</span>             <span class=m>852</span>             <span class=m>1000</span>            <span class=m>1000</span>   0x0000000076af0000 2020-04-28 19:19:35 UTC+0000
</span></span><span class=line><span class=cl>0xffff99baf6a3cd80 chromium             <span class=m>861</span>             <span class=m>852</span>             <span class=m>1000</span>            <span class=m>1000</span>   0x000000007692e000 2020-04-28 19:19:35 UTC+0000
</span></span></code></pre></td></tr></table></div></div><p>Le processus que l&rsquo;on cherche est donc le second lancé par <strong>ThreadPoolSingl</strong>.</p><h3 id=à-la-recherche-des-identifiants-perdus>À la recherche des identifiants perdus</h3><p>Le plugin <code>pstree</code> de volatility a déjà été exécuté dans les challenges précédents:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  cat linux_pstree <span class=p>|</span> grep chromium
</span></span><span class=line><span class=cl>.....chromium        <span class=m>119148</span>          <span class=m>1001</span>           
</span></span><span class=line><span class=cl>.......chromium      <span class=m>119163</span>          <span class=m>1001</span>           
</span></span><span class=line><span class=cl>........chromium     <span class=m>119165</span>          <span class=m>1001</span>           
</span></span><span class=line><span class=cl>.........chromium    <span class=m>119218</span>          <span class=m>1001</span>           
</span></span><span class=line><span class=cl>.........chromium    <span class=m>119233</span>          <span class=m>1001</span>           
</span></span><span class=line><span class=cl>.........chromium    <span class=m>119274</span>          <span class=m>1001</span>           
</span></span><span class=line><span class=cl>.........chromium    <span class=m>119302</span>          <span class=m>1001</span>           
</span></span><span class=line><span class=cl>.........chromium    <span class=m>119364</span>          <span class=m>1001</span>           
</span></span><span class=line><span class=cl>.........chromium    <span class=m>119380</span>          <span class=m>1001</span>           
</span></span><span class=line><span class=cl>.........chromium    <span class=m>119394</span>          <span class=m>1001</span>           
</span></span><span class=line><span class=cl>.........chromium    <span class=m>119735</span>          <span class=m>1001</span>           
</span></span><span class=line><span class=cl>.........chromium    <span class=m>119757</span>          <span class=m>1001</span>           
</span></span><span class=line><span class=cl>chromium             <span class=m>119184</span>          <span class=m>1001</span>           
</span></span><span class=line><span class=cl>chromium             <span class=m>119187</span>          <span class=m>1001</span>           
</span></span></code></pre></td></tr></table></div></div><p>En suivant la logique précédente, le processus qui nous intéresse est le <strong>119187</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_pslist <span class=p>|</span> grep chromium
</span></span><span class=line><span class=cl>Volatility Foundation Volatility Framework 2.6.1
</span></span><span class=line><span class=cl>0xffff9d72c1848f80 chromium             <span class=m>119148</span>          <span class=m>1378</span>            <span class=m>1001</span>            <span class=m>1001</span>   0x0000000013768000 2020-03-26 23:27:39 UTC+0000
</span></span><span class=line><span class=cl>0xffff9d72940e8000 chromium             <span class=m>119163</span>          <span class=m>119162</span>          <span class=m>1001</span>            <span class=m>1001</span>   0x0000000001f0c000 2020-03-26 23:27:39 UTC+0000
</span></span><span class=line><span class=cl>0xffff9d72940eae80 chromium             <span class=m>119165</span>          <span class=m>119163</span>          <span class=m>1001</span>            <span class=m>1001</span>   0x000000004213c000 2020-03-26 23:27:39 UTC+0000
</span></span><span class=line><span class=cl>0xffff9d72bd57be00 chromium             <span class=m>119184</span>          <span class=m>119180</span>          <span class=m>1001</span>            <span class=m>1001</span>   0x0000000011360000 2020-03-26 23:27:39 UTC+0000
</span></span><span class=line><span class=cl>0xffff9d72bd57cd80 chromium             <span class=m>119187</span>          <span class=m>119180</span>          <span class=m>1001</span>            <span class=m>1001</span>   0x0000000011296000 2020-03-26 23:27:39 UTC+0000
</span></span><span class=line><span class=cl>0xffff9d729ce6dd00 chromium             <span class=m>119218</span>          <span class=m>119165</span>          <span class=m>1001</span>            <span class=m>1001</span>   0x00000000107da000 2020-03-26 23:27:40 UTC+0000
</span></span><span class=line><span class=cl>0xffff9d7283045d00 chromium             <span class=m>119233</span>          <span class=m>119165</span>          <span class=m>1001</span>            <span class=m>1001</span>   0x0000000003058000 2020-03-26 23:27:40 UTC+0000
</span></span><span class=line><span class=cl>0xffff9d72824e3e00 chromium             <span class=m>119274</span>          <span class=m>119165</span>          <span class=m>1001</span>            <span class=m>1001</span>   0x00000000025dc000 2020-03-26 23:27:46 UTC+0000
</span></span><span class=line><span class=cl>0xffff9d7282481f00 chromium             <span class=m>119302</span>          <span class=m>119165</span>          <span class=m>1001</span>            <span class=m>1001</span>   0x0000000004ece000 2020-03-26 23:27:46 UTC+0000
</span></span><span class=line><span class=cl>0xffff9d7284f86c80 chromium             <span class=m>119364</span>          <span class=m>119165</span>          <span class=m>1001</span>            <span class=m>1001</span>   0x00000000052fe000 2020-03-26 23:27:50 UTC+0000
</span></span><span class=line><span class=cl>0xffff9d7284f82e80 chromium             <span class=m>119380</span>          <span class=m>119165</span>          <span class=m>1001</span>            <span class=m>1001</span>   0x000000001a206000 2020-03-26 23:28:02 UTC+0000
</span></span><span class=line><span class=cl>0xffff9d729a269f00 chromium             <span class=m>119394</span>          <span class=m>119165</span>          <span class=m>1001</span>            <span class=m>1001</span>   0x000000001a29e000 2020-03-26 23:28:02 UTC+0000
</span></span><span class=line><span class=cl>0xffff9d72940e4d80 chromium             <span class=m>119735</span>          <span class=m>119165</span>          <span class=m>1001</span>            <span class=m>1001</span>   0x0000000011234000 2020-03-26 23:39:05 UTC+0000
</span></span><span class=line><span class=cl>0xffff9d72c1848000 chromium             <span class=m>119757</span>          <span class=m>119165</span>          <span class=m>1001</span>            <span class=m>1001</span>   0x0000000002e62000 2020-03-26 23:39:08 UTC+0000
</span></span></code></pre></td></tr></table></div></div><p>On peut exclure tous les processus dont le père est <strong>119165</strong>, car il s&rsquo;agit du broker de Chromium, mais comme vu précédemment le processus que l&rsquo;on cherche ne dépend pas du broker.</p><p>Le broker de Chromium est le processus principal, en l&rsquo;occurrence: <strong>119165</strong>. Ensuite, chaque processus fils seront des sites, des iframes, etc&mldr; Ces processus seront sandboxés par Chromium:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/RMMZ9J7.png data-srcset="https://i.imgur.com/RMMZ9J7.png, https://i.imgur.com/RMMZ9J7.png 1.5x, https://i.imgur.com/RMMZ9J7.png 2x" data-sizes=auto alt=https://i.imgur.com/RMMZ9J7.png title=https://i.imgur.com/RMMZ9J7.png></p><blockquote><p><a href=https://chromium.googlesource.com/chromium/src/+/master/docs/design/sandbox.md target=_blank rel="noopener noreffer">https://chromium.googlesource.com/chromium/src/+/master/docs/design/sandbox.md</a></p></blockquote><p>Les processus <strong>119218, 119233, 119274, 119302, 119364, 119380, 119394, 119735, 119757</strong>, ne nous intéressent donc pas dans ce cas.</p><p>Pour coller au PoC fait dans le chapitre précédent, il faut trouver deux processus <strong>chromium</strong> avec le même parent. Le processus <strong>119180</strong> doit donc être <em>ThreadPoolSingl</em>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_pslist <span class=p>|</span> grep <span class=m>119180</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Offset             Name                 Pid             PPid            Uid             Gid    DTB                Start Time
</span></span><span class=line><span class=cl>------------------ -------------------- --------------- --------------- --------------- ------ ------------------ ----------
</span></span><span class=line><span class=cl>0xffff9d72bd57be00 chromium             <span class=m>119184</span>          <span class=m>119180</span>          <span class=m>1001</span>            <span class=m>1001</span>   0x0000000011360000 2020-03-26 23:27:39 UTC+0000
</span></span><span class=line><span class=cl>0xffff9d72bd57cd80 chromium             <span class=m>119187</span>          <span class=m>119180</span>          <span class=m>1001</span>            <span class=m>1001</span>   0x0000000011296000 2020-03-26 23:27:39 UTC+0000
</span></span></code></pre></td></tr></table></div></div><p>A partir de ce point, il existe au moins deux méthodes pour trouver les identifiants. On sait qu&rsquo;il faut creuser dans le processus <strong>119187</strong>, car comme dans le PoC, il s&rsquo;agit du <strong>second</strong> processus exécuté.</p><h3 id=solution-1---trouver-la-structure-en-mémoire>Solution 1 - Trouver la structure en mémoire</h3><p>En connaissant la structure en mémoire, il est possible de commencer à chercher en partant de la chaine du &ldquo;realm&rdquo;:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/N1u2DQu.png data-srcset="https://i.imgur.com/N1u2DQu.png, https://i.imgur.com/N1u2DQu.png 1.5x, https://i.imgur.com/N1u2DQu.png 2x" data-sizes=auto alt=https://i.imgur.com/N1u2DQu.png title=https://i.imgur.com/N1u2DQu.png></p><p>On peut commencer par chercher le realm <code>Panel-\o/</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_yarascan -Y <span class=s2>&#34;Panel-&#34;</span> -p <span class=m>119187</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>Task: chromium pid <span class=m>119187</span> rule r1 addr 0x7fb1cc163630
</span></span><span class=line><span class=cl>0x7fb1cc163630  <span class=m>50</span> <span class=m>61</span> 6e <span class=m>65</span> 6c 2d 6f 2f <span class=m>00</span> <span class=m>64</span> 6a <span class=m>37</span> <span class=m>33</span> <span class=m>61</span> <span class=m>65</span> <span class=m>77</span>   Panel-o/.dj73aew
</span></span><span class=line><span class=cl>0x7fb1cc163640  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>33</span> <span class=m>69</span> <span class=m>64</span> <span class=m>74</span> <span class=m>70</span> 0a 0e cc b1 7f <span class=m>00</span> <span class=m>00</span>   ....3idtp.......
</span></span><span class=line><span class=cl>0x7fb1cc163650  <span class=m>17</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 1e <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>   ................
</span></span><span class=line><span class=cl>0x7fb1cc163660  6a 4d bb 5f 7a <span class=m>34</span> 0a 9f e0 a0 0e cc b1 7f <span class=m>00</span> <span class=m>00</span>   jM._z4..........
</span></span><span class=line><span class=cl>0x7fb1cc163670  <span class=m>09</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 0e <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>   ................
</span></span><span class=line><span class=cl>0x7fb1cc163680  <span class=m>34</span> <span class=m>19</span> dd 3c f7 a7 5d b8 <span class=m>90</span> 5f <span class=m>17</span> cc b1 7f <span class=m>00</span> <span class=m>00</span>   4..&lt;..<span class=o>]</span>.._......
</span></span><span class=line><span class=cl>0x7fb1cc163690  <span class=m>08</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> 0e <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>   ................
</span></span><span class=line><span class=cl>0x7fb1cc1636a0  <span class=m>88</span> bb <span class=m>94</span> <span class=m>35</span> <span class=m>52</span> <span class=m>22</span> <span class=m>36</span> <span class=m>60</span> <span class=m>03</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> d1 d0 c5 <span class=m>85</span>   ...5R<span class=s2>&#34;6`........
</span></span></span><span class=line><span class=cl><span class=s2>0x7fb1cc1636b0  90 73 15 cc b1 7f 00 00 90 73 15 cc b1 7f 00 00   .s.......s......
</span></span></span><span class=line><span class=cl><span class=s2>0x7fb1cc1636c0  01 00 00 00 00 00 00 00 ac 61 8d 0e 00 00 00 00   .........a......
</span></span></span><span class=line><span class=cl><span class=s2>0x7fb1cc1636d0  0d ff 2b 37 00 00 00 00 52 7b 0c 9d 60 00 2f 00   ..+7....R{..`./.
</span></span></span><span class=line><span class=cl><span class=s2>0x7fb1cc1636e0  a0 03 00 00 00 00 00 00 25 02 00 00 00 00 00 00   ........%.......
</span></span></span><span class=line><span class=cl><span class=s2>0x7fb1cc1636f0  10 93 18 cc b1 7f 00 00 e0 93 1d cc b1 7f 00 00   ................
</span></span></span><span class=line><span class=cl><span class=s2>0x7fb1cc163700  90 8d 15 cc b1 7f 00 00 18 00 00 00 00 00 00 00   ................
</span></span></span><span class=line><span class=cl><span class=s2>0x7fb1cc163710  18 00 00 00 00 00 00 00 4d 31 6a 9e 31 0a a1 0a   ........M1j.1...
</span></span></span><span class=line><span class=cl><span class=s2>0x7fb1cc163720  bb 01 7f a4 fc a1 dc f1 00 00 0b 74 24 db 8d cc   ...........t</span>$<span class=s2>...
</span></span></span></code></pre></td></tr></table></div></div><p>Cette yararule ne ressort que 4 résultats, il est donc aisé de trouver le bloc qui nous intéresse. En suivant la logique définie précédemment:</p><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/WlY72cw.png data-srcset="https://i.imgur.com/WlY72cw.png, https://i.imgur.com/WlY72cw.png 1.5x, https://i.imgur.com/WlY72cw.png 2x" data-sizes=auto alt=https://i.imgur.com/WlY72cw.png title=https://i.imgur.com/WlY72cw.png></p><ul><li>Second pointeur (rouge), adresse de username: <code>0x7fb1cc0ea0e0</code></li><li>Troisième pointeur (vert) adresse de password: <code>0x7fb1cc175f90</code></li></ul><p>Il n&rsquo;y a plus qu&rsquo;à extraire la <strong>Virtual Memory Area</strong> (VMA) et regarder ce qu&rsquo;il y à ces adresses:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_proc_maps -p <span class=m>119187</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>0xffff9d72bd57cd80   <span class=m>119187</span> chromium             0x00007fb1cc000000 0x00007fb1cc4e2000 rw-                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_dump_map -s 0x00007fb1cc000000 -p <span class=m>119187</span> -D /opt/usr_land/wu/119187/
</span></span></code></pre></td></tr></table></div></div><p>Le nom d&rsquo;utilisateur:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  hexdump -C -s 0x0ea0e0 ../187/Wu/task.119187.0x7fb1cc000000.vma <span class=p>|</span> head -n <span class=m>4</span>
</span></span><span class=line><span class=cl>000ea0e0  <span class=m>41</span> <span class=m>00</span> <span class=m>64</span> <span class=m>00</span> 6d <span class=m>00</span> <span class=m>69</span> <span class=m>00</span>  6e <span class=m>00</span> <span class=m>33</span> <span class=m>00</span> 4b <span class=m>00</span> 7a <span class=m>00</span>  <span class=p>|</span>A.d.m.i.n.3.K.z.<span class=p>|</span>
</span></span><span class=line><span class=cl>000ea0f0  <span class=m>37</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  a0 <span class=m>26</span> <span class=m>18</span> cc b1 7f <span class=m>00</span> <span class=m>00</span>  <span class=p>|</span>7........<span class=p>&amp;</span>......<span class=p>|</span>
</span></span><span class=line><span class=cl>000ea100  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=m>25</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=p>|</span>........%.......<span class=p>|</span>
</span></span><span class=line><span class=cl>000ea110  <span class=m>60</span> ab <span class=m>13</span> cc b1 7f <span class=m>00</span> <span class=m>00</span>  <span class=m>20</span> <span class=m>06</span> 1e cc b1 7f <span class=m>00</span> <span class=m>00</span>  <span class=p>|</span><span class=sb>`</span>....... .......<span class=p>|</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Admin3Kz7</p></blockquote><p>Le mot de passe:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  hexdump -C -s 0x175f90 ../187/Wu/task.119187.0x7fb1cc000000.vma <span class=p>|</span> head -n <span class=m>4</span>
</span></span><span class=line><span class=cl>00175f90  <span class=m>35</span> <span class=m>00</span> <span class=m>73</span> <span class=m>00</span> <span class=m>64</span> <span class=m>00</span> <span class=m>74</span> <span class=m>00</span>  <span class=m>59</span> <span class=m>00</span> <span class=m>68</span> <span class=m>00</span> <span class=m>36</span> <span class=m>00</span> <span class=m>38</span> <span class=m>00</span>  <span class=p>|</span>5.s.d.t.Y.h.6.8.<span class=p>|</span>
</span></span><span class=line><span class=cl>00175fa0  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=p>|</span>................<span class=p>|</span>
</span></span><span class=line><span class=cl>00175fb0  <span class=m>11</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=m>75</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span>  <span class=p>|</span>........u.......<span class=p>|</span>
</span></span><span class=line><span class=cl>00175fc0  <span class=m>02</span> <span class=m>00</span> <span class=m>00</span> <span class=m>00</span> b1 7f <span class=m>00</span> <span class=m>00</span>  c0 <span class=m>93</span> <span class=m>02</span> cc b1 7f <span class=m>00</span> <span class=m>00</span>  <span class=p>|</span>................<span class=p>|</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>5sdtYh68</p></blockquote><h3 id=solution-2---la-débrousailleuse>Solution 2 - La débrousailleuse</h3><p>Cette solution a le mérite d&rsquo;etre plus rapide que la première. La première chose à faire est d&rsquo;extraires tous les VMA du processus:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_dump_map -p <span class=m>119187</span> -D /opt/usr_land/119187/all_vma/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  strings --print-file-name 119187/all_vma/* <span class=p>|</span> grep <span class=s1>&#39;http://10.42.42.132&#39;</span>        
</span></span><span class=line><span class=cl>task.119187.0x7fb1cc000000.vma: http://10.42.42.132/
</span></span><span class=line><span class=cl>task.119187.0x7fb1cc000000.vma: http://10.42.42.132/
</span></span><span class=line><span class=cl>task.119187.0x7fb1cc000000.vma: http://10.42.42.132/favicon.ico
</span></span><span class=line><span class=cl>task.119187.0x7fb1cc000000.vma: http://10.42.42.132/
</span></span><span class=line><span class=cl>task.119187.0x7fb1cc000000.vma: http://10.42.42.132/panel/
</span></span></code></pre></td></tr></table></div></div><p>Au final, une seule portion ressort, il suffit de faire un strings UTF-16 dessus pour voir la magie opérer:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  strings -e l -n <span class=m>6</span> task.119187.0x7fb1cc000000.vma
</span></span><span class=line><span class=cl>Admin3Kz7
</span></span><span class=line><span class=cl>5sdtYh68
</span></span><span class=line><span class=cl> !<span class=p>&amp;</span><span class=o>(</span>/01<span class=o>=</span>CEIORS_bcfghmvwxy<span class=o>}</span>
</span></span><span class=line><span class=cl>-78<span class=p>;</span>?ABDFGLMNPTUVW<span class=o>[]</span>jkz<span class=o>{</span><span class=p>|</span>
</span></span><span class=line><span class=cl>+234569HJKQXYZq~
</span></span></code></pre></td></tr></table></div></div><h3 id=flag-5>Flag</h3><blockquote><p>FCSC{Admin3Kz7:5sdtYh68}</p></blockquote><h3 id=bonus-1---keepass>Bonus 1 - Keepass</h3><p>En inspectant les processus en cours d&rsquo;exécution, on remarque un <strong>Keepass</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_psaux
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Pid    Uid    Gid    Arguments
</span></span><span class=line><span class=cl><span class=m>119514</span> <span class=m>1001</span>   <span class=m>1001</span>   /usr/bin/cli /usr/lib/keepass2/KeePass.exe
</span></span></code></pre></td></tr></table></div></div><p>Ne connaissant pas ce processus <strong>cli</strong>, on demande à Google:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ which cli
</span></span><span class=line><span class=cl>/usr/bin/cli
</span></span><span class=line><span class=cl>$ which mono
</span></span><span class=line><span class=cl>/usr/bin/mono
</span></span><span class=line><span class=cl>$ ls -l /usr/bin/mono
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> root root <span class=m>3054984</span> Jul <span class=m>24</span>  <span class=m>2012</span> /usr/bin/mono
</span></span><span class=line><span class=cl>$ ls -l /usr/bin/cli
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> root root <span class=m>21</span> Apr <span class=m>17</span> 16:16 /usr/bin/cli -&gt; /etc/alternatives/cli
</span></span><span class=line><span class=cl>$ ls -l /etc/alternatives/cli
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> root root <span class=m>13</span> Apr <span class=m>17</span> 16:16 /etc/alternatives/cli -&gt; /usr/bin/mono
</span></span></code></pre></td></tr></table></div></div><blockquote><p><a href=https://stackoverflow.com/questions/16426041/what-is-difference-between-cli-and-mono-in-unix target=_blank rel="noopener noreffer">https://stackoverflow.com/questions/16426041/what-is-difference-between-cli-and-mono-in-unix</a>
<a href=https://fr.wikipedia.org/wiki/Common_Language_Infrastructure target=_blank rel="noopener noreffer">https://fr.wikipedia.org/wiki/Common_Language_Infrastructure</a></p></blockquote><h4 id=état-des-lieux-4>État des lieux</h4><p>Donc on peut dire que <strong>cli</strong> == <strong>mono</strong>. Mono est un utilitaire permettant d&rsquo;exécuter le framework .NET de Microsoft sur Linux. Le fait d&rsquo;avoir un &ldquo;Keepass.exe&rdquo; prend son sens.</p><p>On sait que les extensions des containers Keepass ont l&rsquo;extension: <code>.kdbx</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  cestlarentree cat str_* <span class=p>|</span> grep -i kdbx <span class=p>|</span> sort <span class=p>|</span> uniq
</span></span><span class=line><span class=cl>/home/Lesage/Documents/pass/mdp.kdbx
</span></span><span class=line><span class=cl>kdbx
</span></span><span class=line><span class=cl>KDBX_DetailsFull_HTML.xsl
</span></span><span class=line><span class=cl>KDBX_DetailsLight_HTML.xsl
</span></span><span class=line><span class=cl>KDBX_Tabular_HTML.xsl
</span></span><span class=line><span class=cl>mdp.kdbx
</span></span><span class=line><span class=cl>mdp.kdbx - KeePass
</span></span><span class=line><span class=cl>					&lt;Path&gt;../../../home/Lesage/Documents/pass/mdp.kdbx&lt;/Path&gt;
</span></span><span class=line><span class=cl>			&lt;Path&gt;../../../home/Lesage/Documents/pass/mdp.kdbx&lt;/Path&gt;
</span></span></code></pre></td></tr></table></div></div><blockquote><p>/home/Lesage/Documents/pass/mdp.kdbx</p></blockquote><p>Les base de données Keepass semblent avoir une signature:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  file ./test.kdbx 
</span></span><span class=line><span class=cl>test.kdbx: Keepass password database 2.x KDBX
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  hexdump -C ./test.kdbx <span class=p>|</span> head -n <span class=m>2</span> 
</span></span><span class=line><span class=cl><span class=m>00000000</span>  <span class=m>03</span> d9 a2 9a <span class=m>67</span> fb 4b b5  <span class=m>01</span> <span class=m>00</span> <span class=m>03</span> <span class=m>00</span> <span class=m>02</span> <span class=m>10</span> <span class=m>00</span> <span class=m>31</span>  <span class=p>|</span>....g.K........1<span class=p>|</span>
</span></span><span class=line><span class=cl><span class=m>00000010</span>  c1 f2 e6 bf <span class=m>71</span> <span class=m>43</span> <span class=m>50</span> be  <span class=m>58</span> <span class=m>05</span> <span class=m>21</span> 6a <span class=nb>fc</span> 5a ff <span class=m>03</span>  <span class=p>|</span>....qCP.X.!j.Z..<span class=p>|</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/JiKavdx.png data-srcset="https://i.imgur.com/JiKavdx.png, https://i.imgur.com/JiKavdx.png 1.5x, https://i.imgur.com/JiKavdx.png 2x" data-sizes=auto alt=https://i.imgur.com/JiKavdx.png title=https://i.imgur.com/JiKavdx.png></p><blockquote><p><a href=https://keepass.info/help/base/repair.html target=_blank rel="noopener noreffer">https://keepass.info/help/base/repair.html</a></p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_yarascan -Y <span class=s2>&#34;{03 D9 A2 9A 67 FB 4B B5}&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># Y a wallou</span>
</span></span></code></pre></td></tr></table></div></div><p>Le yarascan n&rsquo;est pas très concluant. Faisons un test en local pour voir si le contenu du container se trouve dans la mémoire.</p><h4 id=test-en-local>Test en local</h4><p>Une fois n&rsquo;est pas coutume, on va procéder de la même manière que dans les challenges précédents en installant un Keepass2 sur notre VM de test.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ apt install keepass2
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/maki.bzh/svg/loading.min.svg data-src=https://i.imgur.com/YNFbvBN.png data-srcset="https://i.imgur.com/YNFbvBN.png, https://i.imgur.com/YNFbvBN.png 1.5x, https://i.imgur.com/YNFbvBN.png 2x" data-sizes=auto alt=https://i.imgur.com/YNFbvBN.png title=https://i.imgur.com/YNFbvBN.png></p><ul><li>Master key : JeSuisUnSuperPassword</li><li>Nom de la bdd : TestFCSC_Database</li><li>Entrée utilisateur : TESTENTREEKEEPASS_maki</li><li>Entrée mot de passe : TESTENTREEKEEPASS_PASSWORD</li></ul><p>La première chose à faire est donc d&rsquo;essayer de retrouver la Master key:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  strings test<span class=se>\ </span>ecsc<span class=se>\ </span>deb10-f35aa608.vmem &gt; str
</span></span><span class=line><span class=cl>➜  strings -e l test<span class=se>\ </span>ecsc<span class=se>\ </span>deb10-f35aa608.vmem &gt; str_el
</span></span><span class=line><span class=cl>➜  cat str* <span class=p>|</span> grep <span class=s2>&#34;JeSuisUnSuper&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>Ca ne donne rien. Avant de se décourager, on peut essayer pour les entrées:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  cat str* <span class=p>|</span> grep -E <span class=s2>&#34;TESTENTREEKEEPASS_maki|TESTENTREEKEEPASS_PASSWORD&#34;</span> <span class=p>|</span> uniq <span class=p>|</span> sort
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>TESTENTREEKEEPASS_maki
</span></span><span class=line><span class=cl>TESTENTREEKEEPASS_maki
</span></span><span class=line><span class=cl>TESTENTREEKEEPASS_PASSWORD
</span></span><span class=line><span class=cl>TESTENTREEKEEPASS_PASSWORD
</span></span><span class=line><span class=cl> Title: TESTENTREEKEEPASS_maki, Password: ********, Creation Time: 05/05/2020 17:21:55, Last Modification Time: 
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p>Bon, pas besoin de la master key s&rsquo;il est possible de récupérer les informations. Alors, maintenant il faut réussir à localiser précisément où sont les entrées:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/test<span class=se>\ </span>ecsc<span class=se>\ </span>deb10-f35aa608.vmem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_dump_map -p <span class=m>814</span> -D /opt/usr_land/vma/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  strings --print-file-name -e l * <span class=p>|</span> grep -E <span class=s2>&#34;TESTENTREEKEEPASS_maki|TESTENTREEKEEPASS_PASSWORD&#34;</span> <span class=p>|</span> cut -d<span class=s1>&#39;:&#39;</span> -f1  <span class=p>|</span> uniq
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  strings -e l task.814.0x7f3c83800000.vma <span class=p>|</span> grep -E <span class=s2>&#34;TESTENTREEKEEPASS_maki|TESTENTREEKEEPASS_PASSWORD&#34;</span> <span class=p>|</span> sort <span class=p>|</span> uniq
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>MeGYxEBVnEsTrGroup:HPRIZOIDrzIXZ Database, MeGYxEBVnEsTrTitle:HPRIZOIDrzIXZ TESTENTREEKEEPASS_maki, MeGYxEBVnEsTrPassword:HPRIZOIDrzIXZ ********, MeGYxEBVnEsTrCreation Time:HPRIZOIDrzIXZ 05/05/2020 17:21:55, MeGYxEBVnEsTrLast Modification Time:HPRIZOIDrzIXZ 05/05/2020 17:22:56
</span></span><span class=line><span class=cl>RIZOIDrzIXZ TESTENTREEKEEPASS_maki, MeGYxEBVnEsTrPassword:HPRIZO
</span></span><span class=line><span class=cl>s16 MeGYxEBVnEsTrGroup:HPRIZOIDrzIXZ Database, MeGYxEBVnEsTrTitle:HPRIZOIDrzIXZ TESTENTREEKEEPASS_maki, MeGYxEBVnEsTrPassword:HP
</span></span><span class=line><span class=cl>TESTENTREEKEEPASS_maki
</span></span><span class=line><span class=cl>TESTENTREEKEEPASS_PASSWORD
</span></span><span class=line><span class=cl> Title: TESTENTREEKEEPASS_maki, Password: ********, Creation Time: 05/05/2020 17:21:55, Last Modification Time: 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/test<span class=se>\ </span>ecsc<span class=se>\ </span>deb10-f35aa608.vmem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_proc_maps -p <span class=m>814</span>
</span></span><span class=line><span class=cl>Volatility Foundation Volatility Framework 2.6.1
</span></span><span class=line><span class=cl>Offset             Pid      Name                 Start              End                Flags               Pgoff Major  Minor  Inode      File Path
</span></span><span class=line><span class=cl>------------------ -------- -------------------- ------------------ ------------------ ------ ------------------ ------ ------ ---------- ---------
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>0xffff98a5b9708f80      <span class=m>814</span> cli                  0x00007f3c83800000 0x00007f3c84401000 rw-                   0x0      <span class=m>0</span>      <span class=m>0</span>          <span class=m>0</span> 
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p>Il n&rsquo;y a qu&rsquo;une zone mémoire contenant les informations que l&rsquo;on cherche. Maintenant, on sait que le nom d&rsquo;utilisateur est relativement simple à trouver, car il faut partir d&rsquo;une structure. En théorie, il y a juste à retrouver cette structure. Quant au mot de passe, c&rsquo;est un peu différent, il faut réussir à voir ce qu&rsquo;il y a autour et peut-être déterminer des marqueurs.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  strings -e l --print-file-name * <span class=p>|</span> grep -C <span class=m>2</span> <span class=s2>&#34;TESTENTREEKEEPASS_PASSWORD&#34;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>--
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: SWFClass0.System.Windows.Forms.CheckBox
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: TESTENTREEKEEPAS
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: TESTENTREEKEEPASS_PASSWORD
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: S_PASSWORD
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: TESTENTREEKEEPASS_PASSWORD
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: KeePass.UI.SecureTextBoxEx
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: SWFClass0.KeePass.UI.SecureTextBoxEx
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: TESTENTREEKEEPASS_PASSWORD
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: KeePass.UI.SecureTextBoxEx
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: SWFClass0.KeePass.UI.SecureTextBoxEx
</span></span><span class=line><span class=cl>--
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: SWFClass0.System.Windows.Forms.Button
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: TESTENTREEKEEPAS
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: TESTENTREEKEEPASS_PASSWORD
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: S_PASSWORD
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: TESTENTREEKEEPASS_PASSWORD
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: KeePass.UI.SecureTextBoxEx
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: SWFClass0.KeePass.UI.SecureTextBoxEx
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: TESTENTREEKEEPASS_PASSWORD
</span></span><span class=line><span class=cl>task.814.0x7f3c83800000.vma: System.Windows.Forms.TabControl
</span></span></code></pre></td></tr></table></div></div><p>On peut voir que le mot de passe apparait plusieurs fois autour d&rsquo;une méthode ou d&rsquo;une classe: <strong>SWFClass0.KeePass.UI.SecureTextBoxEx</strong>. Ce qui est un nom plutôt évocateur.</p><h4 id=trouver-le-contenu-du-keepass>Trouver le contenu du keepass</h4><p>Maintenant qu&rsquo;on a trouvé un certain nombre d&rsquo;informations, il est temps de tester sur le Keepass du challenge. Donc même chose que pour le test en local, dump des zones mémoires du keepass et la fameuse technique de &ldquo;la débroussailleuse&rdquo;:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  python volatility/vol.py --plugins<span class=o>=</span>/opt/plug_vol/ -f /opt/usr_land/dmp.mem --profile<span class=o>=</span>Linuxecsc_deb540x64 linux_dump_map -p <span class=m>119514</span> -D /opt/usr_land/keepass
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>➜  strings --print-file-name -e l * <span class=p>|</span> grep <span class=s2>&#34;Title:&#34;</span>  
</span></span><span class=line><span class=cl>task.119514.0x7f3f46338000.vma: IyfTEvOFrjanWGroup:IdmZfHKZcQfnm 453, IyfTEvOFrjanWTitle:IdmZfHKZcQfnm 453, IyfTEvOFrjanWUser Name:IdmZfHKZcQfnm LePasSage, IyfTEvOFrjanWPassword:IdmZfHKZcQfnm ********, IyfTEvOFrjanWCreation Time:IdmZfHKZcQfnm 3/26/2020 2:36:34 PM, IyfTEvOFrjanWLast Modification Time:IdmZfHKZcQfnm 3/26/2020 2:39:59 PM
</span></span><span class=line><span class=cl>task.119514.0x7f3f46338000.vma: IyfTEvOFrjanWGroup:IdmZfHKZcQfnm 453, IyfTEvOFrjanWTitle:IdmZfHKZcQfnm 453, IyfTEvOFrjanWUser Name:IdmZfHKZcQfnm LePasSage, IyfTEvOFrjanWPassword:IdmZfHKZcQfnm ********, IyfTEvOFrjanWCreation Time:IdmZfHKZcQfnm 3/26/2020 2:36:34 PM, IyfTEvOFrjanWLast Modification Time:IdmZfHKZcQfnm 3/26/2020 2:39:59 PM
</span></span><span class=line><span class=cl>task.119514.0x7f3f46338000.vma: IyfTEvOFrjanWGroup:IdmZfHKZcQfnm 453, IyfTEvOFrjanWTitle:IdmZfHKZcQfnm 453, IyfTEvOFrjanWUser Name:IdmZfHKZcQfnm LePasSage, IyfTEvOFrjanWPassword:IdmZfHKZcQfnm ********, IyfTEvOFrjanWCreation Time:IdmZfHKZcQfnm 3/26/2020 2:36:34 PM, IyfTEvOFrjanWLast Modification Time:IdmZfHKZcQfnm 3/26/2020 2:39:59 PM
</span></span><span class=line><span class=cl>task.119514.0x7f3f51000000.vma: <span class=o>{</span><span class=se>\*\g</span>enerator Mono RichTextBox<span class=p>;</span><span class=o>}</span><span class=se>\p</span>ard<span class=se>\f</span>0<span class=se>\f</span>s22 <span class=se>\u</span>l Group:IdmZfHKZcQfnm 453, <span class=se>\u</span>l Title:IdmZfHKZcQfnm 453, <span class=se>\u</span>l User Name:IdmZfHKZcQfnm LePasSage, <span class=se>\u</span>l Password:IdmZfHKZcQfnm ********, <span class=se>\u</span>l Creation Time:IdmZfHKZcQfnm 3/26/2020 2:36:34 PM, <span class=se>\u</span>l Last Modification Time:IdmZfHKZcQfnm 3/26/2020 2:39:59 PM<span class=se>\p</span>ar
</span></span></code></pre></td></tr></table></div></div><p>Si on nettoie un peu la sortie, on peut récupérer un nom d&rsquo;utilisateur:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Group: 453, Title: 453, User Name: LePasSage, Password: ********, Creation Time: 3/26/2020 2:36:34 PM, Last Modification Time: 3/26/2020 2:39:59 PM
</span></span></code></pre></td></tr></table></div></div><blockquote><p>LePasSage</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  keepass strings --print-file-name -e l * <span class=p>|</span> grep <span class=s2>&#34;LePasSage&#34;</span>
</span></span><span class=line><span class=cl>task.119514.0x7f3f46338000.vma: IyfTEvOFrjanWGroup:IdmZfHKZcQfnm 453, IyfTEvOFrjanWTitle:IdmZfHKZcQfnm 453, IyfTEvOFrjanWUser Name:IdmZfHKZcQfnm LePasSage, IyfTEvOFrjanWPassword:IdmZfHKZcQfnm ********, IyfTEvOFrjanWCreation Time:IdmZfHKZcQfnm 3/26/2020 2:36:34 PM, IyfTEvOFrjanWLast Modification Time:IdmZfHKZcQfnm 3/26/2020 2:39:59 PM
</span></span><span class=line><span class=cl>task.119514.0x7f3f46338000.vma: IyfTEvOFrjanWGroup:IdmZfHKZcQfnm 453, IyfTEvOFrjanWTitle:IdmZfHKZcQfnm 453, IyfTEvOFrjanWUser Name:IdmZfHKZcQfnm LePasSage, IyfTEvOFrjanWPassword:IdmZfHKZcQfnm ********, IyfTEvOFrjanWCreation Time:IdmZfHKZcQfnm 3/26/2020 2:36:34 PM, IyfTEvOFrjanWLast Modification Time:IdmZfHKZcQfnm 3/26/2020 2:39:59 PM
</span></span><span class=line><span class=cl>task.119514.0x7f3f46338000.vma: IyfTEvOFrjanWGroup:IdmZfHKZcQfnm 453, IyfTEvOFrjanWTitle:IdmZfHKZcQfnm 453, IyfTEvOFrjanWUser Name:IdmZfHKZcQfnm LePasSage, IyfTEvOFrjanWPassword:IdmZfHKZcQfnm ********, IyfTEvOFrjanWCreation Time:IdmZfHKZcQfnm 3/26/2020 2:36:34 PM, IyfTEvOFrjanWLast Modification Time:IdmZfHKZcQfnm 3/26/2020 2:39:59 PM
</span></span><span class=line><span class=cl>task.119514.0x7f3f47244000.vma: LePasSage
</span></span><span class=line><span class=cl>task.119514.0x7f3f51000000.vma: <span class=o>{</span><span class=se>\*\g</span>enerator Mono RichTextBox<span class=p>;</span><span class=o>}</span><span class=se>\p</span>ard<span class=se>\f</span>0<span class=se>\f</span>s22 <span class=se>\u</span>l Group:IdmZfHKZcQfnm 453, <span class=se>\u</span>l Title:IdmZfHKZcQfnm 453, <span class=se>\u</span>l User Name:IdmZfHKZcQfnm LePasSage, <span class=se>\u</span>l Password:IdmZfHKZcQfnm ********, <span class=se>\u</span>l Creation Time:IdmZfHKZcQfnm 3/26/2020 2:36:34 PM, <span class=se>\u</span>l Last Modification Time:IdmZfHKZcQfnm 3/26/2020 2:39:59 PM<span class=se>\p</span>ar
</span></span></code></pre></td></tr></table></div></div><p>Dans le cadre du challenge, il n&rsquo;y a pas qu&rsquo;un seul espace mémoire contenant le nom d&rsquo;utilisateur, il y a en 3: <strong>task.119514.0x7f3f46338000.vma, task.119514.0x7f3f47244000.vma, task.119514.0x7f3f51000000.vma</strong></p><p>Il ne reste qu&rsquo;à chercher notre marqueur parmi ces trois zones mémoires:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  strings -e l  task.119514.0x7f3f46338000.vma task.119514.0x7f3f47244000.vma task.119514.0x7f3f51000000.vma <span class=p>|</span> grep -C <span class=m>1</span> <span class=s2>&#34;SWFClass0.KeePass.UI.SecureTextBoxEx&#34;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>--
</span></span><span class=line><span class=cl>KeePass.UI.SecureTextBoxEx
</span></span><span class=line><span class=cl>SWFClass0.KeePass.UI.SecureTextBoxEx
</span></span><span class=line><span class=cl>_Rx9PjLIO8Z
</span></span><span class=line><span class=cl>--
</span></span><span class=line><span class=cl>KeePass.UI.SecureTextBoxEx
</span></span><span class=line><span class=cl>SWFClass0.KeePass.UI.SecureTextBoxEx
</span></span><span class=line><span class=cl>_Rx9PjLIO8Z
</span></span><span class=line><span class=cl>--
</span></span><span class=line><span class=cl>KeePass.UI.SecureTextBoxEx
</span></span><span class=line><span class=cl>SWFClass0.KeePass.UI.SecureTextBoxEx
</span></span><span class=line><span class=cl>_Rx9PjLIO8Z
</span></span></code></pre></td></tr></table></div></div><p>Je pense donc le mot de passe est:</p><blockquote><p>_Rx9PjLIO8Z</p></blockquote><p>Cependant les identifiants <strong>LePasSage:_Rx9PjLIO8Z</strong> ne sont pas ceux recherchés pour le challenge, mais peut être qu&rsquo;un jour ça pourra servir.</p></div></div></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.100.2">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2017 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=maki.bzh/ target=_blank>Maki - Alan Marrec</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},lightgallery:!0}</script><script type=text/javascript src=/maki.bzh/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-WVPYCS7SPM',{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-WVPYCS7SPM" async></script></body></html>